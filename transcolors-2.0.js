/** FOR INFORMATION ABOUT TRANSCOLORS AND THE APP, VISIT **\
                  darryl-yeo.com/transcolors
\**                                                      **/

//We finally made it to 1000 votes! Thanks to everyone for being supportive of my work over the past year and a half, and a special hand to those who worked hard to make me some spectacular levels! Updates for the Transcolors App will be coming very soon to my personal website, so stay tuned! For now, please enjoy this brand new, long-anticipated 100-level update! Thanks everyone! -DY

/**            DY's ORIGINAL PROGRAM IS HERE:           **\
   khanacademy.org/cs/transcolors-version-250/2722008038

     Post all questions, comments, and concerns there.
\**                                                     **/

//Mobile Edition!
//www.khanacademy.org/cs/transcolors-version-250-by-dy/2722008038/embedded?width=800&editor=no

/**TIMELINE:
 * 6/26/15: 1250 Votes (An eighth of 10000?)
 * 6/25/15: 1248 Votes
 * 6/24/15: 1247 Votes
 * 6/23/15: 1244 Votes
 * 6/22/15: 1243 Votes
 * 6/21/15: 1243 Votes
 * 6/20/15: 1242 Votes
 * 6/17/15: 1242 Votes
 * 6/16/15: 1240 Votes
 * 6/15/15: 1237 Votes
 * 6/14/15: 1235 Votes
 * 6/12/15: 1235 Votes
 * 6/11/15: 1234 Votes
 * 6/10/15: 1232 Votes
 * 6/9/15: 1231 Votes
 * 6/8/15: 1231 Votes
 * 6/7/15: 1230 Votes
 * 6/6/15: 1228 Votes
 * 6/5/15: 1226 Votes
 * 6/4/15: 1224 Votes
 * 6/3/15: 1223 Votes
 * 6/2/15: 1220 Votes
 * 6/1/15: 1220 Votes
 * 5/31/15: 1218 Votes
 * 5/30/15: 1217 Votes
 * 5/28/15: 1217 Votes
 * 5/27/15: 1216 Votes
 * 5/26/15: 1216 Votes
 * 5/25/15: 1215 Votes
 * 5/24/15: 1214 Votes
 * 5/23/15: 1212 Votes
 * 5/22/15: 1211 Votes
 * 5/21/15: 1211 Votes
 * 5/20/15: 1209 Votes
 * 5/19/15: 1208 Votes
 * 5/18/15: 1205 Votes
 * 5/17/15: 1204 Votes
 * 5/16/15: 1204 Votes
 * 5/15/15: 1203 Votes
 * 5/14/15: 1202 Votes (1200 and still counting steadily!)
 * 5/13/15: 1198 Votes
 * 5/12/15: 1197 Votes
 * 5/11/15: 1195 Votes
 * 5/10/15: 1192 Votes
 * 5/09/15: 1192 Votes
 * 5/08/15: 1190 Votes
 * 5/07/15: 1190 Votes
 * 5/06/15: 1188 Votes
 * 5/05/15: 1187 Votes
 * 5/04/15: 1181 Votes
 * 5/03/15: 1181 Votes
 * 5/02/15: 1180 Votes
 * 5/01/15: 1177 Votes
 * 4/30/15: 1171 Votes
 * 4/29/15: 1168 Votes
 * 4/28/15: 1167 Votes
 * 4/27/15: 1162 Votes
 * 4/26/15: 1161 Votes
 * 4/25/15: 1159 Votes
 * 4/24/15: 1149 Votes
 * 4/23/15: 1147 Votes
 * 4/22/15: 1145 Votes
 * 4/21/15: 1139 Votes
 * 4/20/15: 1139 Votes
 * 4/19/15: 1138 Votes
 * 4/18/15: 1139 Votes
 * 4/17/15: 1137 Votes
 * 4/16/15: 1135 Votes
 * 4/15/15: 1135 Votes
 * 4/14/15: 1133 Votes
 * 4/13/15: 1132 Votes
 * 4/12/15: 1130 Votes
 * 4/11/15: 1127 Votes
 * 4/10/15: 1121 Votes
 * 4/09/15: 1120 Votes
 * 4/08/15: 1113 Votes (One thousand eleventy-one!)
 * 4/07/15: 1110 Votes
 * 4/06/15: 1106 Votes
 * 4/05/15: 1102 Votes
 * 4/04/15: 1100 Votes (Woot, eleven hundred!)
 * 4/03/15: 1099 Votes
 * 4/02/15: 1094 Votes
 * 4/01/15: 1092 Votes
 * 3/31/15: 1089 Votes
 * 3/29/15: 1089 Votes
 * 3/28/15: 1087 Votes
 * 3/27/15: 1086 Votes
 * 3/26/15: 1086 Votes
 * 3/25/15: 1083 Votes
 * 3/24/15: 1080 Votes
 * 3/23/15: 1080 Votes
 * 3/22/15: 1079 Votes
 * 3/21/15: 1077 Votes
 * 3/20/15: 1074 Votes
 * 3/19/15: 1072 Votes
 * 3/17/15: 1070 Votes
 * 3/16/15: 1068 Votes
 * 3/15/15: 1068 Votes
 * 3/14/15: 1066 Votes
 * 3/13/15: 1065 Votes
 * 3/12/15: 1064 Votes
 * 3/11/15: 1064 Votes
 *                                                              *logger malfunction?
 * 3/9/15: 1060 Votes
 * 3/8/15: 1055 Votes
 * 3/7/15: 1055 Votes
 * 3/6/15: 1055 Votes
 * 3/5/15: 1053 Votes
 * 3/4/15: 1053 Votes
 * 3/3/15: 1050 Votes
 * 3/2/15: 1050 Votes
 * 3/1/15: 1047 Votes
 * 2/28/15: 1046 Votes
 * 2/27/15: 1046 Votes (?)
 * 2/26/15: 1047 Votes
 * 2/25/15: 1044 Votes
 * 2/24/15: 1041 Votes
 * 2/23/15: 1040 Votes
 * 2/22/15: 1036 Votes
 * 2/21/15: 1033 Votes
 * 2/20/15: 1029 Votes
 * 2/19/15: 1025 Votes
 * 2/18/15: 1024 Votes
 * 2/17/15: 1022 Votes
 * 2/16/15: 1021 Votes
 * 2/15/15: 1018 Votes
 * 2/15/15 12:23 PM: 1000 VOTES! (YIPPEE! THANKS EVERYONE!!!)
 * 2/14/15: 998 Votes
 * 2/13/15: 997 Votes
 * 2/12/15: 996 Votes
 * 2/11/15: 991 Votes
 * 2/10/15: 990 Votes
 * 2/9/15: 988 Votes
 *                                                              *staging site broke
 * 2/7/15: 982 Votes
 *                                                              *KA changed their scratchpad data structure
 * 2/5/15: 975 Votes
 * 2/4/15: 970 Votes
 * 2/3/15: 966 Votes
 * 2/2/15: 964 Votes
 * 2/1/15: 962 Votes
 * 1/31/15: 958 Votes
 * 1/30/15: 957 Votes
 * 1/29/15: 952 Votes
 * 1/28/15: 951 Votes
 * 1/27/15: 952 Votes
 * 1/26/15: 950 Votes (950! I can't wait for 1000!)
 *                                                              *cron malfunction
 * 1/24/15: 947 Votes
 * 1/23/15: 943 Votes
 * 1/22/15: 943 Votes
 * 1/21/15: 941 Votes
 * 1/20/15: 937 Votes
 * 1/19/15: 936 Votes
 * 1/18/15: 935 Votes
 * 1/17/15: 935 Votes
 * 1/16/15: 932 Votes
 * 1/15/15: 929 Votes
 * 1/14/15: 926 Votes
 * 1/13/15: 923 Votes
 * 1/12/15: 923 Votes
 * 1/11/15: 922 Votes
 * 1/10/15: 919 Votes
 * 1/9/15: 916 Votes
 * 1/8/15: 914 Votes
 * 1/7/15: 913 Votes
 * 1/6/15: 913 Votes
 * 1/5/15: 912 Votes
 * 1/4/15: 908 Votes
 * 1/3/15: 907 Votes
 * 1/2/15: 905 Votes
 * 1/1/15: 903 Votes (Happy New Year! Don't forget to update your copyright dates!)
 * 12/31/14: 903 Votes
 * 12/30/14: 902 Votes
 * 12/29/14: 900 Votes (Yes! Woohoo! Thanks guys!!!)
 * 12/28/14: 897 Votes
 * 12/27/14: 897 Votes
 * 12/26/14: 896 Votes
 * 12/25/14: 897 Votes (Happy Holidays, everyone!)
 *
 * 12/22/14: 895 Votes
 * 12/21/14: 895 Votes
 * 12/20/14: 891 Votes
 * 12/19/14: 890 Votes
 * 12/18/14: 885 Votes
 * 12/17/14: 884 Votes
 * 12/16/14: 885 Votes
 * 12/14/14: 885 Votes
 *                                                               (missed)
 * 12/12/14: 883 Votes (Okay...)
 * 12/11/14: 884 Votes
 * 12/8/14: 884 Votes
 * 12/7/14: 882 Votes
 * 12/6/14: 880 Votes
 * 12/5/14: 880 Votes
 * 12/4/14: 876 Votes
 * 12/2/14: 876 Votes (went to 871 earlier...)
 * 12/1/14: 872 Votes (...)
 *                                                               (missed)
 * 11/29/14: 875 Votes
 * 11/28/14: 873 Votes
 * 11/27/14: 872 Votes
 *                                                               (missed)
 * 11/25/14: 867 Votes
 * 11/24/14: 866 Votes
 * 11/23/14: 864 Votes
 *                                                               (missed)
 * 11/21/14: 859 Votes
 * 11/20/14: 857 Votes
 * 11/19/14: 854 Votes
 * 11/18/14: 852 Votes (850 and still moving along!)
 * 11/17/14: 847 Votes
 * 11/16/14: 844 Votes                                           *guess 11/17
 * 11/15/14: 844 Votes
 * 11/14/14: 842 Votes
 * 11/13/14: 841 Votes
 * 11/11/14: 841 Votes
 * 11/10/14: 837 Votes
 * 11/9/14: 836 Votes
 * 11/8/14: 833 Votes
 * 11/7/14: 832 Votes
 * 11/6/14: 830 Votes
 * 11/5/14: 829 Votes
 * 11/4/14: 828 Votes
 * 11/3/14: 825 Votes (This gets annoying.)
 * 11/2/14: 826 Votes
 * 11/1/14: 826 Votes
 * 10/31/14: 824 Votes (Happy Halloween!)
 * 10/30/14: 823 Votes
 * 10/29/14: 820 Votes
 * 10/28/14: 817 Votes
 * 10/27/14: 814 Votes
 * 10/26/14: 812 Votes
 * 10/25/14: 813 Votes
 * 10/24/14: 811 Votes
 * 10/23/14: 811 Votes
 * 10/22/14: 810 Votes
 * 10/21/14: 809 Votes
 * 10/20/14: 808 Votes (Earlier today it was 809...)
 * 10/19/14: 806 Votes
 * 10/18/14: 806 Votes
 * 10/17/14: 802 Votes (800 Votes! When will 1000 come around?)
 * 10/16/14: 799 Votes (And... and...!)
 * 10/15/14: 795 Votes
 * 10/14/14: 794 Votes
 * 10/13/14: 791 Votes
 * 10/12/14: 790 Votes
 * 10/11/14: 790 Votes
 * 10/10/14: 788 Votes
 * 10/9/14: 787 Votes
 * 10/8/14: 786 Votes
 * 10/7/14: 785 Votes
 * 10/6/14: 785 Votes (...)
 * 10/5/14: 787 Votes (...)
 * 10/4/14: 788 Votes
 * 10/3/14: 787 Votes
 * 10/2/14: 784 Votes
 * 10/1/14: 783 Votes
 * 9/30/14: 783 Votes (Huh...? A DECREASE in votes?!)
 * 9/29/14: 785 Votes
 * 9/28/14: 784 Votes
 * 9/22/14: 784 Votes
 * 9/21/14: 783 Votes
 * 9/20/14: 782 Votes
 * 9/19/14: 782 Votes
 * 9/16/14: 781 Votes
 * 9/15/14: 780 Votes
 * 9/14/14: 780 Votes
 * 9/13/14: 778 Votes
 * 9/11/14: 778 Votes
 * 9/10/14: 777 Votes (Lucky day!)
 * 9/9/14: 776 Votes
 * 9/8/14: 776 Votes
 * 9/7/14: 775 Votes
 * 9/6/14: 774 Votes
 * 9/5/14: 772 Votes
 * 9/4/14: 771 Votes
 * 9/3/14: 769 Votes
 * 9/2/14: 768 Votes
 * 9/1/14: 767 Votes
 * 8/31/14: 766 Votes
 * 8/28/14: 766 Votes
 * 8/27/14: 764 Votes
 * 8/26/14: 758 Votes (Woo! Five votes today!)
 * 8/25/14: 753 Votes
 * 8/22/14: 753 Votes
 * 8/21/14: 751 Votes
 * 8/20/14: 751 Votes (A quarter thousand! Hooray!)
 * 8/19/14: 748 Votes
 * 8/18/14: 748 Votes
 * 8/17/14: 747 Votes
 * 8/16/14: 744 Votes
 * 8/15/14: 742 Votes
 * 8/14/14: 741 Votes
 * 8/13/14: 739 Votes
 *  --------- [Transcolors was hidden from 7/31/14 to 8/11/14, most likely due to a flag for using disallowed functionality. The local storage code was still in the program but commented out. After I reported the problem to KA, it has been unhidden.] ---------
 * 7/31/14: 739 Votes (We've been hidden! No!)
 * 7/30/14: 739 Votes
 * 7/29/14: 739 Votes
 * 7/28/14: 738 Votes
 * 7/27/14: 735 Votes
 * 7/25/14: 735 Votes
 * 7/24/14: 733 Votes
 * 7/23/14: 732 Votes
 * 7/22/14: 730 Votes
 * 7/21/14: 729 Votes
 * 7/20/14: 727 Votes
 * 7/19/14: 726 Votes
 * 7/18/14: 725 Votes
 * 7/17/14: 723 Votes
 * 7/16/14: 721 Votes
 * 7/14/14: 721 Votes
 * 7/13/14: 720 Votes
 * 7/12/14: 719 Votes
 * 7/11/14: 719 Votes
 * 7/10/14: 717 Votes
 * 7/9/14: 716 Votes
 * 7/8/14: 714 Votes
 * 7/7/14: 711 Votes
 * 7/6/14: 708 Votes
 * 7/4/14: 708 Votes
 * 7/3/14: 707 Votes
 * 7/2/14: 707 Votes
 * 7/1/14: 706 Votes
 * 6/30/14: 705 Votes
 * 6/29/14: 703 Votes
 * 6/25/14: 703 Votes
 * 6/24/14: 702 Votes (700! Awesome! Must...get...1000!)
 * 6/23/14: 698 Votes
 * 6/22/14: 695 Votes
 * 6/21/14: 694 Votes
 * --------- [Gone between 6/15 and 6/20; data from outside source] ---------
 * 6/19/14: 693 Votes
 * 6/18/14: 691 Votes
 * 6/16/14: 690 Votes
 * --------------------------------------------------------------------------
 * 6/14/14: 688 Votes
 * 6/13/14: 686 Votes
 * 6/12/14: 686 Votes
 * 6/11/14: 685 Votes
 * 6/10/14: 685 Votes
 * 6/9/14: 683 Votes
 * 6/8/14: 683 Votes
 * 6/7/14: 682 Votes
 * 6/6/14: 682 Votes
 * 6/5/14: 681 Votes
 * 6/4/14: 680 Votes
 * 6/3/14: 677 Votes
 * 6/2/14: 672 Votes
 * 6/1/14: 672 Votes
 * 5/31/14: 671 Votes                                           *guess 6/1
 * 5/30/14: 671 Votes
 * 5/29/14: 668 Votes
 * 5/28/14: 667 Votes
 * 5/27/14: 663 Votes
 * 5/26/14: 662 Votes
 * 5/25/14: 661 Votes
 * 5/24/14: 660 Votes (?!)
 * 5/23/14: 660 Votes
 * 5/22/14: 658 Votes
 * 5/21/14: 653 Votes
 * 5/20/14: 650 Votes
 * 5/19/14: 647 Votes                                           *eval 5/20
 * 5/18/14: 643 Votes (Is the streak ending already?)
 * 5/17/14: 642 Votes (Oh no! What happened today?)
 * 5/16/14: 642 Votes
 * 5/15/14: 635 Votes
 * 5/14/14: 625 Votes
 * 5/13/14: 618 Votes
 * 5/12/14: 610 Votes
 * 5/11/14: 598 Votes
 * 5/10/14: 593 Votes
 * 5/9/14: 586 Votes
 * 5/8/14: 578 Votes
 * 5/7/14: 568 Votes
 * 5/6/14: 561 Votes
 * 5/5/14: 558 Votes
 * 5/4/14: 555 Votes (555 on the day before 5/5...?)
 * 5/3/14: 552 Votes
 * 5/2/14: 547 Votes
 * 5/1/14: 535 Votes
 * 4/30/14: 524 Votes
 * 4/29/14: 515 Votes
 * 4/28/14: 503 Votes (500!!! BOOYEAH! Thank you so much, all of my wonderful KA supporters! Keep telling your folks about Transcolors and the app!)
 * 4/27/14: 494 Votes
 * 4/26/14: 489 Votes
 * 4/25/14: 486 Votes
 * 4/24/14: 477 Votes
 * 4/23/14: 472 Votes
 * 4/22/14: 466 Votes
 * 4/21/14: 460 Votes
 * 4/20/14: 456 Votes
 * 4/19/14: 452 Votes
 * 4/18/14: 447 Votes (444 on the 4th month of '14!)
 * 4/17/14: 441 Votes
 * 4/16/14: 432 Votes
 * 4/15/14: 424 Votes (Transcolors's First Anniversary!)
 * 4/14/14: 419 Votes
 * 4/13/14: 408 Votes
 * 4/12/14: 407 Votes
 * 4/11/14: 402 Votes (400! Yay! Let's go for 1000!)
 * 4/10/14: 396 Votes
 * 4/9/14: 385 Votes
 * 4/8/14: 378 Votes
 * 4/7/14: 369 Votes (365...What a number!)
 * 4/6/14: 360 Votes
 * 4/5/14: 357 Votes
 * 4/4/14: 351 Votes
 * 4/3/14: 346 Votes
 * 4/2/14: 330 Votes
 * 4/1/14: 317 Votes (Passed 300! April Fool's! Not!)
 * 3/31/14: 299 Votes
 * 3/30/14: 288 Votes
 * 3/29/14: 283 Votes
 * 3/28/14: 279 Votes
 * 3/27/14: 276 Votes
 * 3/26/14: 270 Votes
 * 3/25/14: 257 Votes
 * 3/24/14: 241 Votes
 * 3/23/14: 229 Votes (Started Avatar Edition today. Let's see how this might change!)
 * 3/22/14: 215 Votes
 * 3/21/14: 203 Votes (Just broke 200!)
 * 3/20/14: 179 Votes
 * 3/19/14: 167 Votes
 * 3/18/14: 157 Votes
 * 3/17/14: 147 Votes
 * 3/16/14: 127 Votes
 * 3/15/14: 119 Votes
 * 3/14/14: 108 Votes (Passed 100 on a Friday Pi Day!)
 * 3/13/14: 93 Votes! Wow!
 * 3/12/14: 74 Votes (11:00 AM) to 83 Votes (Mustafa Mian's publicity)
 * 3/11/14: 73 Votes
 * 3/10/14: 73 Votes
 * 3/9/14: 71 Votes
 * 3/8/14: 70 Votes
 * 3/7/14: 69 Votes
 * 3/6/14: 68 Votes
 * 3/5/14: 66 Votes
 * 3/4/14: 65 Votes
 * 3/3/14: 64 Votes
 * 3/2/14: 63 Votes
 * 3/1/14: 63 Votes
 * 2/28/14: 62 Votes
 * 2/27/14: 62 Votes
 * 2/26/14: 62 Votes
 * 2/25/14: 61 Votes
 * 2/24/14: 58 Votes
 * 2/23/14: 53 Votes
 * 2/22/14: 45 Votes
 * 2/21/14: 42 Votes
 * 2/20/14: 30 Votes
 * 2/19/14: 17 Votes
 * Before 2/19/14: 3 Votes
*/

//Curious about how some of the effects were done? Check out DY's spin-offs of this program to get a good look!

/**Featured on:
 * Tony Baloney's iPod Touch 5th Gen:
       /cs/tony-baloneys-ipod-touch-5th-gen/5040359192133632
 * Mustafa Mian's Interactive iPhone 5C:
                  /cs/interactive-iphone-5c/4882226510561280
 */

/**
 * 1st Anniverary: /cs/happy-birthday/6662013812998144
 * Sneak peek the app!:  /cs/app-screenshot/6264939590189056
 * Play with KA Avatars: /cs/avatar-edition/5248409377177600
 * Compare with Version 1.0:  /cs/transcolors-172/1553568203
 * See the promo poster:   /cs/promo-poster/5801489777819648
 */

/**KNOWN BUGS:
 * not always saving game after clicking "Click to continue"
 * restarting custom level while testing erases level
 * countdown does not pause when pausing
*/

/**TODO:
 * brick breaking animation
 * make constructors for objects
 * randomInt() to replace all floor(random(...))
 * turn all x, y pairs into vectors
 * figure out number of lines in message (!!)
 * use "for in" where possible
 * use more constant variables
*/

/**ACCEPTED CUSTOM LEVELS TO ADD:
 * The Modern Ninja (Level 2)
 * https://www.khanacademy.org/computer-programming/spin-off-of-transcolors-version-247-by-dy/6749704002732032
 * bommer1234 (Level 1, 2)
 * https://www.khanacademy.org/computer-programming/spin-off-of-transcolors-version-250-by-dy/5899153277976576
 * ElectrifyPro (Level 1)
 * https://www.khanacademy.org/computer-programming/spin-off-of-transcolors-version-250-by-dy/6742429400825856
 * kbimbatti22 (Color Swap, Resting Tree, Nab and Grab, Snatch and Break)
 * https://www.khanacademy.org/computer-programming/custom-level/4931509432352768
 * Tzirlya (Level 1, 2)
 * https://www.khanacademy.org/computer-programming/spin-off-of-transcolors-version-250-by-dy/6531328237109248
 * Riley (Level 1)
 * https://www.khanacademy.org/computer-programming/new-level-idea-back-and-forth/6722983243677696
 * Andy Phan (Level 1)
 * https://www.khanacademy.org/computer-programming/my-saved-game/5445092920918016
*/

var canvasSize = height;

size(canvasSize * 2, canvasSize, 0);
scale(canvasSize / 400, canvasSize / 400);

var revertSize = function(){
    resetMatrix();
    size(canvasSize, canvasSize, 0);
    scale(canvasSize / 400, canvasSize / 400);
};

var version = "2.5.0";

/**
 * 2/15/15 12:23 PM (Version 2.5.0) – 47 more levels, with 100 LEVELS TOTAL! Revamped level titles, tutorials, and gameplay order. Fixed messages not showing up consistently. The button to restart a level is now SPACE instead of SHIFT to avoid accidental restarts. Replaced arrow text characters with icons. Decreased countdown time.
 * 9/23/14 (Version 2.4.7) – You can now press SPACE or an arrow key to start a level.
 * 8/16/14 (Version 2.4.6) – Updated DY logo
 * 8/11/14 (Version 2.4.5) – Put the jiggly text on the title screen to rest!
 * 6/22/14 (Version 2.4.4) – Fixed bug where Smiley could move in Create a Level; Very minor bug fix involving messages and cursor changing in Create a Level
 * 6/11/14 (Version 2.4.3) – Smoother transitions between title, announcements, and FAQs; mouse correctly detected when changing canvas size
 * 5/30/14 (Version 2.4.2) – Updated "Tips for Making Great Transcolors Levels."
 * 5/16/14 (Version 2.4.1) – Disabled local storage – Khan Academy doesn't allow it. :(
 * 4/29/14 (Version 2.4.0) – TWO NEW USER CREATED LEVELS! Keep 'em coming!
 * 4/24/14 (Version 2.3.1) – Links page and fixed crash when visiting Create A Level (yes, I still want some more levels!)
 * 4/6/14 (Version 2.3.0) – New Levels! Level Select has multiple pages now! Also a few bug fixes including one where editing the code makes a level reset and cause it to revert to a regular level while testing a custom level.
 * 3/23/14 (Version 2.2.3) – Bug fix where custom level select displayed title and author
 * 3/16/14 (Version 2.2.2) – Press "d" for debug mode and "m" to disable mobile edition (use this before saving so that your program thumbnail doesn't get squished.)
 * 3/15/14 (Version 2.2.1) – Level title and author appear in level select
 * 3/11/14 (Version 2.2.0) – 10 NEW USER CREATED LEVELS!
 * 3/3/14 (Version 2.1.2) – Game screen also has a gradient
 * 2/23/14 (Version 2.1.1) – Eye-popping gradient background for title screen
 * 2/22/14 (Version 2.1.0) – 10 NEW USER CREATED LEVELS!
 * 2/21/14 (Version 2.0.3) – Added option of saving game with code
 * 2/20/14 (Version 2.0.2) – Game is scaleable to any size
 * 2/20/14 (Version 2.0.1) – Press SHIFT and RETURN keys to replay level or go to next level
 *
 *
 * 11/8/13 (Version 1.7.2) – New Super-tricky Level!
 * 10/18/13 (Version 1.7.1) – New Level
 * 7/30/13 (Version 1.7.0) – Numerous Corrections, Edits, Bug Fixes, Reordering of Stuff, etc., etc., etc.
 * 7/18/13 (Version 1.6.12) – New Background
 * 7/18/13 (Version 1.6.11) – New Level
 * 7/8/13 (Version 1.6.10) – Fixed Custom Flag Coloring Bug
 * 7/8/13 (Version 1.6.9) – New Level
 * 7/8/13 (Version 1.6.8) – Bug Fixes With Level Tips, etc
 * 7/7/13 (Version 1.6.7) – New Level
 * 7/7/13 (Version 1.6.6) – New Level
 * 7/4/13 (Version 1.6.5) – New Level
 * 6/30/13 (Version 1.6.4) – New Level
 * 6/22/13 (Version 1.6.3) – 3 New Levels!
 * 6/21/13 (Version 1.6.2) – New Level
 * 6/17/13 (Version 1.6.1) – New Level
 * 6/9/13 (Version 1.6.0) – New Level and Barrier Brightness
 * 6/3/13 (Version 1.5.2) – New Level and 100 VOTES!
 * 6/1/13 (Version 1.5.1) – Create multiple levels!
 * 5/31/13 (Version 1.5.0) – Redesigned Level Select! Play your custom-made levels!
 * 5/27/13 (Version 1.4.2) – Cursor changing! How cool is that?
 * 5/26/13 (Version 1.4.1) – Brand new wall Animation!
 * 5/24/13 (Version 1.4.0) – Walls come back after you restart!
 * 5/23/13 (Version 1.3.2) – Added announcements page
 * 5/22/13 (Version 1.3.1) – Added 1 more level and fixed bug that makes the game crash when finishing level
 * 5/21/13 (Version 1.3.0) – Added Time and CREATE A LEVEL!
 * 5/18/13 (Version 1.2.2) – More code improvements, plus some framework to prepare for Create a Level...
 * 5/15/13 (Version 1.2.1) – Smiley has victory message; reworked some code and UI
 * 5/12/13 (Version 1.2.0) – 5 new levels!
 * 5/10/13 – MOBILE EDITION! PLAY ON YOUR MOBILE DEVICE!
 * Started 4/15/13 (Version 1.1.0)
*/

//Save your game – paste the variables here! No cheating, please!
var game = {
    username: "",
    stats: [
        {moves: 0, time: 0}
    ],
    font: "Avenir",
    betterPerformance: false
};

//[Deprecated]
//useLocalStorage: true

game.barrierBrightness = 5;
game.flashingColors = true;

/*
var unloadGame = function(){
    //@@@
    if(getItem("TranscolorsData") && getItem("TranscolorsUsername") &&
        getItem("TranscolorsFont") && getItem("TranscolorsMoves") && getItem("TranscolorsTime") && getItem("TranscolorsPerformance")){
        //game = getItem("TranscolorsData");
        game.username = getItem("TranscolorsUsername");
        game.font = getItem("TranscolorsFont");
        game.betterPerformance = getItem("TranscolorsPerformance");
        
        var movesData = getItem("TranscolorsMoves").split("/");
        var timeData = getItem("TranscolorsTime").split("/");
        for(var i = 0; i < min(movesData.length, timeData.length); i++){
            game.stats[i] = {
                moves: movesData[i] === "N/A" ? undefined : movesData[i],
                time: timeData[i] === "N/A" ? undefined : timeData[i]
            };
        }
    }
};

unloadGame();
*/

{

var myBackground = function(){
    colorMode(HSB);
    //background((frameCount / 4) % 255, 170, 160);
    //fill((frameCount / 4) % 255, 170, 160, 50);
    //rect(0, 0, 400, 400);
    strokeWeight(6);
    for(var y = 0; y <= 400; y += 5){
        stroke((y / 10 + frameCount / 4) % 255, 170, 160);
        line(0, y, canvasSize * 2, y);
    }
    colorMode(RGB);
};

var titleBackground = function(){
    //Gradient Background for title screen
    colorMode(HSB);
    strokeWeight(6);
    for(var y = 0; y <= 400; y += 5){
        stroke((y / 10 + frameCount / 4) % 255, 200, 200);
        line(0, y, canvasSize * 2, y);
    }
    colorMode(RGB);
};


//Object that stores a pair of numbers
var vec = function(x, y){
    return {
        x: x,
        y: y,
        isEqual: function(vec2){
            return this.x === vec2.x && this.y === vec2.y;
        }
    };
};

/**↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ Change these or add more!**/
var winMessage = ["Amazing!", "Awesome!", "Beat that!", "Cool!", "Done!", "Excellent!", "Fantastic!", "Finished!", "Good work!", "Got it!", "Great!", "Great Job!", "Hooray!", "I did it!", "I rock!", "I win!", "Lovely!", "Nice!", "Oh yeah!", "Outstanding!", "Perfect!", "Sublime!", "Superb!", "Sweet!", "Swell!", "Too easy!", "Über-Cool!", "Well Done!", "Whee!", "Wonderful!", "Woo-hoo!", "Wow!", "Yay!", "Yes!"];

var colors = ["R", "Y", "G", "B"];

var randomColor = function(){
    return colors[floor(random() * colors.length)];
};

var colorNames = function(colorID){
    switch(colorID){
        case "R": return "red";
        case "Y": return "yellow";
        case "G": return "green";
        case "B": return "blue";
    }
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                  Character Based on Color                  *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var transformer = function(c){
    switch(c){
        case "R": return "r";
        case "Y": return "y";
        case "G": return "g";
        case "B": return "b";
    }
},
brick = function(c){
    switch(c){
        case "R": return "®";
        case "Y": return "¥";
        case "G": return "©";
        case "B": return "∫";
    }
},
gate = function(c){
    switch(c){
        case "R": return "‰";
        case "Y": return "Á";
        case "G": return "˝";
        case "B": return "ı";
    }
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                       Custom Levels                        *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var customLevels = [0];

var newCustomLevel = function(data, sX, sY, sC, fX, fY, fC, tutorial, author, title){
    var myLevel = {
        data: data,
        size: max(data.length, data[0].length),
        start: {
            pos: vec(sX, sY),
            color: sC
        },
        finish: {
            pos: vec(fX, fY),
            color: fC
        },
        startColorEqualsFinishColor: (!sC && !fC),
        author: author,
        title: title
    };
    
    customLevels.push(myLevel);
};

var newPresetCustomLevel = function(){
    var customLevelSize = floor(random(8, 16.999));
    var customLevelData = [];
    
    for(var y = 0; y < customLevelSize; y++){
        customLevelData[y] = "";
        for(var x = 0; x < customLevelSize; x++){
            var blockToAdd = "";
            switch(floor(random(0, 45))){
                case 0: blockToAdd = transformer(randomColor()); break;
                case 1: blockToAdd = brick(randomColor()); break;
                case 2: blockToAdd = gate(randomColor()); break;
                case 3: blockToAdd = "."; break;
                default: blockToAdd = "0";
            }
            customLevelData[y] += blockToAdd;
        }
    }
    
    newCustomLevel(customLevelData,
        floor(random(0, customLevelSize)), floor(random(0, customLevelSize)),
        randomColor(),
        floor(random(0, customLevelSize)), floor(random(0, customLevelSize)),
        randomColor());
};
}

/** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** **\
*  ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ CUSTOM LEVELS HERE ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓  *
\** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** **/

/*
//Placeholder
newCustomLevel([
    "00000",
    "00000",
    "00000",
    "00000",
    "00000"
    ],
    0, 0, "?",
    0, 0, "?");
*/


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                           Levels                           *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var levels = [0];

var newLevel = function(data, sX, sY, sC, fX, fY, fC, tutorial, author, title){
    var myLevel = {
        data: data,
        size: max(data.length, data[0].length),
        start: {
            pos: vec(sX, sY),
            color: sC
        },
        finish: {
            pos: vec(fX, fY),
            color: fC
        },
        startColorEqualsFinishColor: (!sC && !fC),
        tutorial: tutorial,
        author: author ? author : "DY",
        title: title
    };
    
    levels.push(myLevel);
};

//Level 1
newLevel([
    ".........",
    ".0000000.",
    ".......0.",
    ".00000.0.",
    ".0...0.0.",
    ".0.000.0.",
    ".0.....0.",
    ".0000000.",
    "........."
    ],
    1, 1, 0,
    3, 5, 0,
    "Get Smiley to the flag. Use the arrow keys!",
    0,
    "Smiley's Quest");

//Level 2
newLevel([
    "............",
    "............",
    "............",
    "............",
    "............",
    "...00000.00.",
    "0000......00",
    "...00000000.",
    "............",
    "............",
    "............",
    "............"
    ],
    0, 6, 0,
    11, 6, 0,
    "Get there as fast as possible!",
    0,
    "Onward!");

//Level 3
newLevel([
    "0.0...",
    "0.0000",
    "0..0.0",
    "0000.0",
    "0....0",
    "0000.0"
    ],
    5, 5, 0,
    0, 0, 0,
    "",
    "PigTornado",
    "Move!");

//Level 4
newLevel([
    ".....",
    ".000.",
    "..0..",
    "..r..",
    "....."
    ],
    1, 1, colors[floor(random(1, 4))],
    3, 1, "R",
    "Step on flashing tiles to match colors.",
    0,
    "Match The Flag!");

//Level 5
newLevel([
    ".............",
    ".............",
    ".............",
    ".............",
    ".............",
    "...r...g.....",
    "0000000000000",
    ".....y...b...",
    ".............",
    ".............",
    ".............",
    ".............",
    "............."
    ],
    0, 6, "B",
    12, 6, colors[floor(random(0, 3))],
    "Pick the right color!",
    0,
    "Between Colors");

//Level 6
newLevel([
    ".0000",
    "00y00",
    "0r0g0",
    "00b00",
    ".000."
    ],
    3, 0, "G",
    2, 2, "B",
    0,
    "PigTornado",
    "Color-Matching");

//Level 7
newLevel([
    "...........",
    ".00000000..",
    ".0000000r0.",
    ".000000.00.",
    ".00000y000.",
    ".0000.0000.",
    ".000g00000.",
    ".00.000000.",
    ".0b0000000.",
    "..00000000.",
    "..........."
    ],
    1, 1, randomColor(),
    9, 9, randomColor(),
    "You're getting the hang of this!",
    0,
    "Colorful Staircase");

//Level 8
newLevel([
    ".......",
    ".b000g.",
    ".00000.",
    ".00000.",
    ".00000.",
    ".0000y.",
    "......."
    ],
    2, 4, "R",
    1, 5, "G",
    "Keep it up!",
    0,
    "Color Corners");

//Level 9
newLevel([
    ".......",
    ".b.....",
    ".0.....",
    ".000©0.",
    ".0.....",
    ".g.....",
    "......."
    ],
    1, 3, "B",
    5, 3, "B",
    "That brick is blocking the flag. Destroy it somehow!",
    0,
    "Brick-Blocked!");

//Level 10
newLevel([
    ".......",
    ".y.g.r.",
    ".∫.¥.©.",
    ".00000.",
    ".00000.",
    ".00000.",
    "......."
    ],
    1, 5, "B",
    5, 5, "R",
    "You got it!",
    "ArsenalFan11",
    "In And Out");

//Level 11
newLevel([
    ".........",
    ".........",
    ".........",
    "...g.b...",
    ".0¥0©0¥0.",
    "...r.y...",
    ".........",
    ".........",
    ".........",
    ],
    1, 4, "Y",
    7, 4, "R",
    0,
    0,
    "Color Code");

//Level 12
newLevel([
    "........",
    ".g0∫∫0b.",
    ".00∫∫00.",
    "0©©..®®.",
    "0©©..®®.",
    ".00¥¥00.",
    ".y0¥¥0r.",
    "........"
    ],
    2, 1, "G",
    0, 3, "B",
    "Smashing bricks is fun!",
    "ArsenalFan11",
    "A Day At The Races");

//Level 13
newLevel([
    "y0000g",
    "..0...",
    "000000",
    "0.0∫.b",
    "00.¥®.",
    "r00.©0"
    ],
    2, 5, "Y",
    5, 5, "Y",
    0,
    0,
    "Brick Barricade");

//Level 14
newLevel([
    "0©000®0",
    "©y©0®g®",
    "0©000®0",
    "0000000",
    "0∫000¥0",
    "∫r∫0¥0¥",
    "0∫000¥0"
    ],
    3, 3, "B",
    5, 5, "R",
    "You've completed 13 levels! Save your game to your Khan Academy account by clicking \"Save Game\" in the pause menu!",
    0,
    "Flowers");

//Level 15
newLevel([
    "©©00®¥©0",
    "r©00®¥©©",
    "∫∫00®¥¥¥",
    "y∫00®®®®",
    "®®000000",
    "g®000000",
    "¥¥000000",
    "b¥000000"
    ],
    4, 5, "B",
    7, 0, "B",
    0, "Pinkwaddlesq", "Unblock the Blocks");

//Level 16
newLevel([
    "000000000",
    "®.©.....0",
    "∫.b000r©0",
    "¥.0...0.0",
    "0.000.0.0",
    "......0.0",
    ".0g000y.0",
    ".0....©.0",
    ".00000000"
    ],
    2, 8, "G",
    0, 4, "B",
    "Brownie points for deciphering the title of this level.",
    "ArsenalFan11",
    "Gute Stufe!");

//Level 17
newLevel([
    "............",
    ".0000®¥©000.",
    ".0.....∫000.",
    ".0.0®0.¥000.",
    ".0.0.g.∫0.0.",
    ".0.0y0b0..0.",
    ".0.¥.r.0..0.",
    ".0.000©0..0.",
    ".0.0......0.",
    ".0.0......0.",
    ".0.00000000.",
    "............"
    ],
    5, 5, "R",
    1, 10, "R",
    "Which route is better? Go for the LEAST amount of moves!",
    "QuantumParticle",
    "There and Back Again");

//Level 18
newLevel([
    "®®®®®®®®®",
    "®¥¥¥¥¥¥¥®",
    "®¥©©©©©¥®",
    "®¥©∫∫∫©¥®",
    "®¥©∫0∫©¥®",
    "®¥©©g∫©¥®",
    "®¥¥¥¥y©¥®",
    "®®®®®®r¥®",
    "0¥©∫¥©∫b®"
    ],
    4, 4, "B",
    0, 8, "B",
    "Smash all the bricks the first time, then replay this level and try to achieve the least possible moves!",
    "Goldsplash", "Spiralrainbowcolorfun!!!");

//Level 19
newLevel([
    "00000000000000000000",
    "0........0.....0...0",
    "0.000000.0.00000.000",
    "0.0....0.0.0.....0..",
    "000.0000.0.0.0000000",
    "....0....0.0...0...0",
    "00000000000000.0.r.0",
    "0.0......0.0...0.0.0",
    "0.000.00.0.00000.000",
    "0...0.0..0.......0.0",
    "0.000.000000000000.0",
    "0.0.......0.0......0",
    "0.0000.00.0.00000000",
    "0..0.0.0..0.0......0",
    "0000.0.0.00.000000.0",
    ".....0.0.0..0....0.0",
    "y00000.0.00.0.0000.0",
    ".......0..0.0.0.....",
    "00000000000.0.0000®0",
    "...................0"
    ],
    0, 0, "R",
    19, 19, "Y",
    "Here's some maze practice before we move onto something new!",
    "Anonymous",
    "The Giant Maze");

//Level 20
newLevel([
    "..............",
    ".0000.0000000.",
    ".0...00.0...0.",
    ".00000.00.000.",
    "...0..00.00...",
    ".0.0.0.00.00..",
    ".000.00.0..00.",
    ".0..00.0.000..",
    ".0.00.0000..0.",
    ".0..00..0..00.",
    ".000.000.000..",
    "...0.0.0.0..0.",
    ".00000.000000.",
    ".............."
    ],
    6, 6, "R",
    7, 7, "R",
    "Pro tip: Click on the screen to spotlight the flag. This will help you in the later levels!",
    0, "Winding Tunnels");

//Level 21
newLevel([
    ".........",
    ".........",
    ".........",
    "...0b0...",
    "...ı.‰...",
    ".0000000.",
    ".........",
    ".........",
    "........."
    ],
    1, 5, "R",
    7, 5, "B",
    "Gates open up if you match their color, otherwise they close back up!",
    "penguin9541", "Loop");

//Level 22
newLevel([
    ".........",
    ".........",
    ".........",
    ".g.0ı0.y.",
    ".000Á0∫©.",
    ".b.0˝0.r.",
    ".........",
    ".........",
    "........."
    ],
    2, 4, "R",
    1, 4, "Y",
    "Great work! That's it for the gameplay introduction – you've learned it all. Good luck, and see you at Level 100!",
    0,
    "Candy");

//Level 23
newLevel([
    ".....",
    ".b0..",
    ".ıÁ0.",
    ".∫¥∫.",
    "....."
    ],
    2, 1, "Y",
    3, 2, "B",
    "This game has a simple theme of matching colors. It seems easy now, but soon you'll see how complicated the levels will get with these simple rules!",
    "Island2d",
    "To the Power of 1");

//Level 24
newLevel([
    ".....",
    ".r0b.",
    ".Á®ı.",
    ".0˝g.",
    ".....",
    ],
    1, 3, "Y",
    2, 1, "G",
    "Thanks to my various level authors for helping me create 73 out of the 100 levels in this release!",
    "Goldsplash", "Micropuzzle");

//Level 25
newLevel([
    ".....",
    ".gÁr.",
    ".®¥‰.",
    ".0Á0.",
    "....."
    ],
    3, 3, "Y",
    1, 3, "G",
    "Interested in making some levels for me? Head to \"Create A Level\" in the main menu!",
    "mhogwarts",
    "Small Yet Hard");

//Level 26
newLevel([
    ".........",
    ".g0ı0Á00.",
    ".˝.0.0.0.",
    ".000000˝.",
    ".‰.0.0.0.",
    ".00‰0Á00.",
    ".y.0.0.0.",
    ".0Á0000r.",
    "........."
    ],
    3, 3, "B",
    7, 1, "Y",
    "You're 25% there. Don't forget to save your game to your Khan Academy account under \"Save Game\" in the pause menu.",
    0,
    "Grid");

//Level 27
newLevel([
    "ı00Á0",
    "0Áı0Á",
    "0ı.00",
    "Á0..ı",
    "00Áb0"
    ],
    3, 2, "Y",
    0, 4, "B",
    0,
    0,
    "Twice Around The Block");

//Level 28
newLevel([
    ".......",
    ".b0ı...",
    ".0.0...",
    ".˝00©r.",
    "...∫.©.",
    "...‰00.",
    "......."
    ],
    3, 3, "G",
    5, 5, "R",
    "Symmetry is key to making a good puzzle.",
    0,
    "Figure 8");

//Level 29
newLevel([
    "....00....",
    "....∫∫....",
    "....©©....",
    "....g0....",
    "....˝ı....",
    "....˝ı....",
    "....˝ı....",
    "....˝ı....",
    "....˝ı....",
    "....0b...."
    ],
    4, 9, "B",
    5, 0, "G",
    0,
    "",
    "Travellator");

//Level 30
newLevel([
    ".........",
    "...b0r...",
    "...000...",
    "...˝‰ı...",
    "...˝‰ı...",
    "...˝‰ı...",
    "...000...",
    "..000®0..",
    "........."
    ],
    2, 7, "G",
    6, 7, "B",
    0, "Emmett", "Tunnels");

//Level 31
newLevel([
    "0000000b.0000",
    "0.0.0.0g.0000",
    "0.0.0.0y.‰ı˝Á",
    "˝.ı.Á.‰..rgbr",
    "0.0.0.0..0000",
    "∫.©.¥.¥0g.000",
    "00000000b.000",
    "......00r.‰˝Á",
    "00000000y.gby",
    "‰.ı.˝.Á..0000",
    "©.¥.©.∫.00000",
    "0000000000000",
    "............."
    ],
    0, 0, "R",
    11, 0, "W",
    0, "TheEternalSwarm", "Which Gate?");

//Level 32
newLevel([
    "g∫00¥b",
    "∫0000¥",
    "000000",
    "000000",
    "‰0000®",
    "g‰00®y"
    ],
    0, 3, "R",
    3, 3, "G",
    "Don't get trapped in by the gates! Hit the restart button at top left when you get stuck.",
    "Pinkwaddlesq", "Colorful Trap");

//Level 33
newLevel([
    "0000000b",
    "0..∫.∫.0",
    "0.g¥.y.0",
    "0..000.0",
    "0.‰0...0",
    "˝.‰000Á0",
    "0©0.....",
    "r.000000"
    ],
    0, 0, "R",
    7, 7, "R",
    0, "Charles B", "The Maze");

//Level 34
newLevel([
    "0........",
    "®........",
    "∫..b..r..",
    "©..¥..˝..",
    "000000000",
    ".ı..¥..©.",
    ".g..r..y.",
    ".........",
    "........."
    ],
    8, 4, "G",
    0, 0, "B",
    0,
    "Goldsplash", "Don't Forget Anything...");

//Level 35
newLevel([
    "0©¥∫®0...",
    "©¥∫®000..",
    "¥∫®00000.",
    "∫®00.0.00",
    "®00.˝r‰.0",
    "000©g.b∫0",
    ".00.Áyı.0",
    "..00.¥.00",
    "...00000."
    ],
    1, 5, "G",
    0, 0, "G",
    0, "21st Century Lego", "'Round and 'Round");

//Level 36
newLevel([
    "ÁÁÁÁÁ",
    "Á∫.0©",
    "Áy0g¥",
    "ııb˝©",
    "y∫¥©b"
    ],
    2, 2, "B",
    3, 1, "B",
    0,
    "Goldsplash", "Three Colors");

//Level 37
newLevel([
    "..........",
    ".000Áb000y",
    ".Á.0....Á.",
    ".0.0....0.",
    ".0.0....Á.",
    ".0.0Áb000.",
    ".0......0.",
    ".0.000..0.",
    ".000b0y.0.",
    "...000...."
    ],
    1, 5, "R",
    8, 8, "Y",
    "You can also restart the level with SHIFT!",
    "penguin9541",
    "Booby Traps");

//Level 38
newLevel([
    "..g∫¥0",
    "0000.y",
    "0..©.‰",
    "∫b.y.‰",
    ".00..r",
    "..000˝"
    ],
    5, 5, "G",
    5, 0, "G",
    0, "mhogwarts", "The Trap");

//Level 39
newLevel([
    "˝0000ıy",
    "b˝.00.Á",
    "˝.00.00",
    "000.000",
    ".0.00.0",
    "ı000.˝0",
    "yı00ıbı"
    ],
    3, 0, "G",
    4, 3, "Y",
    "",
    "ArsenalFan11",
    "The Best Route");

//Level 40
newLevel([
    ".........",
    "......0g.",
    ".bı0..˝ı.",
    ".0‰00000.",
    ".......0.",
    ".0˝00000.",
    ".yÁ0..©®.",
    "......Á0.",
    "........."
    ],
    3, 2, "R",
    7, 7, "Y",
    0,
    0,
    "Small Loops");

//Level 41
newLevel([
    "..Á00.00g",
    "..0.Á.0.ı",
    "˝00‰y.˝00",
    "0.¥...b.0",
    "g.0©000∫0",
    "000.....©",
    "....00000",
    "....0.˝.∫",
    "....00b.0"
    ],
    2, 2, "R",
    8, 8, "B",
    0,
    "Tillvit",
    "Loop-de-Loop");

//Level 42
newLevel([
    ".........",
    ".........",
    "..y0000..",
    "..Á.g.0..",
    "..Á.‰.‰..",
    "..00000..",
    "..0...¥..",
    "..0¥∫bÁ..",
    "........."
    ],
    4, 5, "R",
    2, 7, "B",
    0,
    0, "Stay On Your Guard");

//Level 43
newLevel([
    ".......",
    ".000˝˝.",
    ".000¥b.",
    ".g00®y.",
    ".000˝˝.",
    ".r0000.",
    "......."
    ],
    1, 1, "G",
    5, 5, "B",
    0,
    "Theler", "Think Before You Act");

//Level 44
newLevel([
    "bı0©",
    "˝0g∫",
    "r0ı0",
    "00˝r"
    ],
    0, 3, "Y",
    2, 0, "R",
    0, "Goldsplash", "Minipuzzle");

//Level 45
newLevel([
    ".........",
    ".........",
    "...∫ı©...",
    ".g.®‰®.y.",
    ".000.0©∫.",
    ".b.©˝®.r.",
    "...®Á∫...",
    ".........",
    "........."
    ],
    2, 4, "R",
    1, 4, "Y",
    0,
    0,
    "Color Sieve");

//Level 46
newLevel([
    "˝˝˝˝˝˝‰‰‰‰‰",
    "˝y®®000¥¥g‰",
    "˝®®®0.0¥¥¥‰",
    "˝®®®000¥¥¥‰",
    "˝000000000‰",
    "˝0.00000.0∫",
    "˝000000000©",
    "˝©©©000ııı©",
    "˝©©©0.0ııı©",
    "˝b©©000ıı0©",
    "˝˝˝˝˝y©©©©©"
    ],
    5, 5, "R",
    9, 9, "Y",
    0,
    "Goldsplash", "Four-Square");

//Level 47
newLevel([
    ".b0ıy0.",
    ".‰ıg00.",
    ".®...0.",
    ".00000.",
    ".y...©.",
    ".Á...©.",
    ".r‰©©©."
    ],
    3, 3, "R",
    2, 0, "B",
    0,
    "Tillvit",
    "Road Block");

//Level 48
newLevel([
    "000.0.©0000",
    ".b0.0.0...0",
    ".r0.0ı0...0",
    "000.Á.....0",
    "∫...0.000ı0",
    "0ıy00.b...0",
    "0.....000˝0",
    "0.........0",
    "0..b...g..0",
    "0..0...0..0",
    "0‰000ı00000"
    ],
    0, 0, "R",
    4, 0, "B",
    0,
    "penguin9541",
    "Squiggles");

//Level 49
newLevel([
    "bıııı0",
    "ÁÁÁÁıı",
    "‰‰‰ÁÁÁ",
    "r˝gÁ˝y",
    "ÁÁ˝Á˝˝",
    "0Á˝˝˝b"
    ],
    0, 5, "Y",
    5, 0, "B",
    0,
    "Goldsplash", "Color Paths");

//Level 50
newLevel([
    "...........",
    ".....‰‰‰‰˝‰",
    "...r‰‰Á˝‰˝‰",
    "g˝˝Áy˝Á‰‰˝‰",
    "Á‰˝˝˝˝Á0˝‰‰",
    "ÁbÁÁÁÁ0ÁÁÁ‰",
    "ÁıııııÁ..‰‰",
    "ÁÁg˝˝rÁ..‰.",
    ".ÁÁÁy‰Á..‰.",
    "...ÁÁ‰‰‰‰‰.",
    "..........."
    ],
    6, 5, "Y",
    7, 4, "R",
    0, "Goldsplash", "Colorful Maze");

//Level 51
newLevel([
    "˝˝˝ıııııı",
    "˝.˝ı....ı",
    "˝.gı.ıııı",
    "˝˝‰‰‰ıÁÁb",
    "b˝‰y‰ıÁ.ı",
    "ııÁÁ‰ÁÁÁ.",
    ".ıÁ‰‰‰®‰0",
    ".ıÁÁÁÁÁÁÁ",
    ".ııg˝˝˝0Á"
    ],
    8, 6, "R",
    7, 8, "G",
    0,
    "The Nuclear Reactor",
    "Our Walls Go!");

//Level 52
newLevel([
    "..........",
    ".0∫ııb˝®0.",
    ".0˝˝˝˝˝®®.",
    ".00000000.",
    ".00000000.",
    ".00000000.",
    ".®®®00000.",
    ".Á.®000‰‰.",
    ".g©®000¥y.",
    ".........."
    ],
    1, 1, "R",
    8, 1, "B",
    "Smash away those bricks!",
    "summitwei",
    "Breaking Bricks");

//Level 53
newLevel([
    "00000ı¥¥",
    "00000Áb¥",
    "00000˝‰Á",
    "....Á000",
    "b..‰r˝00",
    "g˝b0ı000",
    "‰..0.00‰",
    "0y˝000Áy"
    ],
    0, 7, "R",
    0, 1, "B",
    0,
    "Tillvit",
    "One Way");

//Level 54
newLevel([
    "......",
    ".0∫©y.",
    ".˝˝©¥.",
    ".©‰‰¥.",
    ".r®∫b.",
    "......"
    ],
    1, 1, "G",
    1, 1, "R",
    "Don't be hasty!",
    "Island2d",
    "To the Power of 2");

//Level 55
newLevel([
    "................",
    "...0000b........",
    "...0‰‰‰‰........",
    "...0¥©ır........",
    "...Á˝...........",
    "...000˝000......",
    "...00‰rı00000...",
    "...000Á0000Á0...",
    "...0000000˝g‰...",
    "...00000000ı0...",
    "...0‰00000000...",
    "...ıyÁ0000000...",
    "...0˝0000ı00....",
    "...00000Áb˝0....",
    "......000‰00....",
    "................"
    ],
    3, 5, "R",
    3, 1, "R",
    0,
    0,
    "Flowers 2");

//Level 56
newLevel([
    "®©∫00000",
    "y.®.©.∫0",
    ".b®g©r∫0",
    "00000000",
    "‰....Á..",
    "0000ı0ı0",
    "∫....¥.0",
    "r....0.0"
    ],
    7, 7, "B",
    5, 7, "Y",
    "Think you're up for making a level for me? Go to \"Create a Level\" from the main menu – I can't wait to see what you can come up with!",
    "Tillvit",
    "Passages");

//Level 57
newLevel([
    "˝00.yÁ0ryg0",
    "˝.0.ı.00000",
    "˝.0.0.....®",
    "˝.0.00000.¥",
    "˝.0....∫..©",
    "˝.0000˝0000",
    "˝......ı...",
    "˝.‰‰‰‰‰000b",
    "˝.‰........",
    "b.‰‰‰‰‰‰‰‰r",
    "ııııııııııı"
    ],
    10, 0, "R",
    8, 3, "Y",
    0,
    "Anonymous",
    "Caves");

//Level 58
newLevel([
    "0ı©®000˝r",
    "00..˝ı©0˝",
    ".00‰g©r˝0",
    "0¥00‰b‰®®",
    "¥Á000‰y.®",
    "¥r˝000‰.©",
    "ÁÁy˝000.∫",
    "g∫∫.000.ı",
    "0b˝000000"
    ],
    0, 8, "R",
    8, 2, "B",
    0, "THEG∆MERM∆GE", "Point of Entry");

//Level 59
newLevel([
    "000000.®®®®®®.000000",
    "0000...r....®...0000",
    "0000...˝000Á0.000000",
    "000.....000.0y...000",
    "000.0..gÁ000®Á0r.000",
    "000.0..˝.00..¥...000",
    "000....0000000.00000",
    "000000.¥.......00000",
    "00000..‰.....0000000",
    "0000...0.........000",
    "000....0...0.....000",
    "00.....0...0......00",
    "00.00..000000..00.00",
    "00.000.0y00y0.000.00",
    "00.00..000000..00.00",
    "00....00000000....00",
    "00000.00....00.00000",
    "00000....00....00000",
    "0000...000000...0000",
    "000....000000....000"
    ],
    12, 2, "G",
    11, 13, "Y",
    "Kudos, it's not easy to turn a picture into a playable puzzle!",
    "Tillvit",
    "Mario");

//Level 60
newLevel([
    "..................",
    "...........00‰r00.",
    ".....00....g˝˝˝˝0.",
    ".....000.......00.",
    ".......0...00ı000.",
    ".......00000...©..",
    "..0b...00..©0000..",
    "..000¥000.........",
    "......‰‰‰‰..g0....",
    "......0000..00....",
    ".....00000000.....",
    ".....000000.......",
    "....00000000......",
    "....000©©©00......",
    "...0000©0©0000....",
    "...˝.ı.....ı.˝....",
    "...00000b00000....",
    ".................."
    ],
    6, 2, "Y",
    8, 14, "B",
    0,
    "alexander.chipshot",
    "Withered Tree");

//Level 61
newLevel([
    "y00¥®∫Ágı‰Á∫ıır",
    "ıbr....˝....ÁÁÁ",
    "ırı000000000ÁÁÁ",
    "¥.0...˝‰˝...0.∫",
    "¥.0.0000000.0.∫",
    "¥.0.0.....0.0.∫",
    "¥.0.0.rby.0.0.¥",
    "¥.0®0˝000˝0¥0.∫",
    "∫.0˝0.000.0˝0.∫",
    "¥.0.0..∫..0.0.∫",
    "¥.0.0000000.0.∫",
    "¥.0....˝....0.∫",
    "¥.00000000000.∫",
    "¥......0......∫",
    "¥®®®®®®®®®®®®®∫"
    ],
    8, 8, "Y",
    6, 8, "G",
    0,
    "Goldsplash", "Green Key");

//Level 62
newLevel([
    "bı0000¥0",
    "˝˝0000¥¥",
    "000000ıı",
    "000000˝g",
    "00000®®®",
    "00000®©©",
    "00000®ıı",
    "r0000®Áy"
    ],
    0, 4, "B",
    7, 0, "B",
    0,
    "awessumpossum13",
    "Colors of the Rainbow");

//Level 63
newLevel([
    "0.r‰ıg",
    "©˝˝00˝",
    "®.000∫",
    "∫ı00.y",
    "®.0..‰",
    "000b‰0"
    ],
    5, 5, "R",
    0, 0, "Y",
    0,
    "mhogwarts",
    "Up or Left?");

//Level 64
newLevel([
    "0.r000.",
    "®b‰∫.00",
    "©.®˝..0",
    "¥®0®..0",
    "0.g.©©0",
    "0y.©©.0",
    "0000.gı"
    ],
    6, 4, "B",
    0, 0, "B",
    0,
    "mhogwarts",
    "Unreachable");

//Level 65
newLevel([
    "bı000ır",
    "˝00.0.‰",
    "000000©",
    "‰∫0.©..",
    "yÁ.g000",
    "......0",
    "0Á∫®000"
    ],
    6, 6, "Y",
    0, 6, "Y",
    0,
    "mhogwarts",
    "Gimme the Gold!");

//Level 66
newLevel([
    "∫©®®®®˝∫©©.",
    "∫©®.®®©ı.©.",
    "∫©®.‰Á©©Áy.",
    "ı˝‰.∫∫...‰.",
    "ı˝r.000®®®.",
    "ı˝‰.®....‰.",
    "ıg‰.ı.Áy.®.",
    "ı∫ıı¥©∫ı.b.",
    ".¥ÁÁÁ©Áıı .",
    ".˝˝˝˝©˝˝˝g.",
    ".....ÁÁÁÁÁ."
    ],
    5, 4, "R",
    4, 4, "Y",
    0, "mhogwarts", "Wrong Color");

//Level 67
newLevel([
    "000©˝0gı®00",
    "0©0©‰‰‰‰∫00",
    "0©0©©©©©©00",
    "®ı000∫®∫00Á",
    "∫‰0..∫®..‰®",
    "0©........®",
    "0r.y©..rb.0",
    "∫..©©00∫0..",
    "∫.b®©0©©00.",
    "®.00©0ıy©0.",
    "®®0‰¥00Á©00"
    ],
    10, 10, "R",
    10, 6, "Y",
    0,
    "mhogwarts", "M");

//Level 68
newLevel([
    "gı00˝y‰00",
    "˝0000ı0.‰",
    "00‰0000ı0",
    "0Áy‰00Á®0",
    "˝.Á0000˝0",
    "©Á0000‰.r",
    "¥ı000ıb.‰",
    "∫.......0",
    "∫∫0∫¥©®®®"
    ],
    8, 7, "R",
    2, 8, "R",
    0,
    "mhogwarts", "Behind Grab");

//Level 69
newLevel([
    "ıı∫ıııııııı",
    "ı¥‰‰‰‰‰ÁÁ˝©",
    "ıı‰Á¥¥¥∫Á˝ı",
    "¥ı‰Áy¥ÁıÁ˝ı",
    "rı‰Áı∫ÁıÁ˝ı",
    "‰‰‰Áı0ÁıÁ˝ı",
    "ÁÁÁÁı˝˝©∫˝ı",
    "Áıııı0ııÁ˝ı",
    "Á©˝˝˝˝ıÁÁ˝ı",
    "Áıııı˝ıÁ∫¥©",
    "ÁÁÁÁbgı¥ııı"
    ],
    5, 7, "G",
    5, 5, "R",
    0, "mhogwarts", "Impossible");

//Level 70
newLevel([
    "r‰000.00",
    "Á00Á¥©.0",
    "00˝y.®.0",
    "0...0Á.0",
    "00bıgb‰0",
    ".∫...Á.0",
    "˝00b.y.0",
    "gı0‰0®00"
    ],
    7, 0, "R",
    4, 3, "Y",
    0,
    "mhogwarts",
    "One Entrance");

//Level 71
newLevel([
    "r∫ı00ı00",
    "b∫‰00.00",
    "∫∫ı00.00",
    "®ıı.0.00",
    "®¥¥¥Á000",
    "®ı®©‰000",
    "©0®.ÁÁ‰0",
    "©g..Áy‰0"
    ],
    7, 0, "B",
    1, 6, "Y",
    0, "THEG∆MERM∆GE", "Towers");

//Level 72
newLevel([
    "¥©©.000.0000",
    "¥.∫...0.0..0",
    "®.∫¥0.000..0",
    "®........000",
    "0000000.g0.b",
    "0.....0..0..",
    "0ıgÁÁ.0.ııı.",
    "0®∫¥¥¥0.ıyı.",
    "0.....0.ı∫ı.",
    "000...0..000",
    "..0...0....0",
    "b¥0∫r.000000"
    ],
    4, 0, "R",
    4, 2, "R",
    0,
    "Poohbear",
    "Walls");

//Level 73
newLevel([
    "∫g‰®©®0",
    "ı..‰˝®˝",
    "00b∫∫Áy",
    "00000.¥",
    "∫¥ı.¥¥¥",
    "‰˝0r...",
    "0000®∫g"
    ],
    6, 0, "G",
    6, 0, "Y",
    0,
    "mhogwarts",
    "Back and Forth");

//Level 74
newLevel([
    "00¥g¥∫∫©©¥∫r",
    "00¥¥¥∫∫©©¥∫∫",
    "¥¥000∫∫©©¥¥¥",
    "b¥000∫∫©©©©©",
    "¥¥0000∫©©©©©",
    "©©©©0yÁ.....",
    "©©©©©Áy∫....",
    "∫∫∫∫∫.∫∫∫...",
    "∫∫∫∫∫..∫©©©©",
    "¥¥¥∫∫...©g00",
    "©©¥∫∫...©0b0",
    "r©¥∫∫...©000"
    ],
    11, 11, "R",
    0, 0, "R",
    0,
    "THE PIXEL HERO",
    "PathBrick");

//Level 75
newLevel([
    ".............",
    ".ıy˝bı.y˝0˝b.",
    ".ıÁ˝ıı.Á.0.Á.",
    ".ıÁgı˝©00000.",
    ".ı..g˝.¥.0.ı.",
    ".ııı˝˝.r¥0˝b.",
    "...∫.....∫...",
    ".00000.00000.",
    ".00000.....0.",
    ".00000®0.r.0.",
    ".©©00¥.0.©.0.",
    ".b©0¥0.00000.",
    "............."
    ],
    2, 8, "B",
    5, 11, "R",
    0,
    "Goldsplash", "Rooms");
/*
//Level 75
newLevel([
    ".............",
    ".ıy˝bı.y˝0˝g.",
    ".ıÁ˝ıı.Á.0.‰.",
    ".ıÁgı˝©00000.",
    ".ı..g˝.‰.0.ı.",
    ".ıı0˝˝.rı0˝b.",
    "...∫.....∫...",
    ".00000.00000.",
    ".00000.....0.",
    ".00000®0.r.0.",
    ".©©00¥.0.©.0.",
    ".b©0¥0.00000.",
    "............."
    ],
    2, 8, "B",
    5, 11, "R",
    0,
    "Goldsplash", "Rooms");*/

//Level 76
newLevel([
    ".000....000....000",
    "g000®00®000‰00‰000",
    ".000....000....000",
    "..˝......‰......¥.",
    "..0......0......0.",
    "..0......‰......0.",
    "..˝....00000....¥.",
    ".©00...00000...¥¥¥",
    "0©00Á0Á00000∫0∫000",
    ".©0r...00000...000",
    "..¥....00000....0.",
    "..0......˝......0.",
    "..0......0......0.",
    "..¥......˝......0.",
    ".000....000....000",
    ".0¥0Á00Á0000®®0000",
    ".©®©....000....000",
    "..b......y......r."
    ],
    9, 8, "B",
    0, 8, "B",
    "What's the least amount of moves needed to escape The Box?",
    "alexander.chipshot",
    "The Box");

//Level 77
newLevel([
    "g˝®˝yÁ®®",
    "ı®®®ı®®Á",
    "®®®®®®ıb",
    "..®.®.®‰",
    "0‰®®®®®®",
    "¥Á®®®®®¥",
    "∫.ı.‰..˝",
    "∫∫∫®®©©©"
    ],
    0, 4, "R",
    0, 4, "G",
    "Don't forget – you can click on the screen to highlight the flag.",
    "mhogwarts",
    "The Creepy Face");

//Level 78
newLevel([
    "0.0∫∫∫∫...000000",
    "000.∫.∫00.0....0",
    "0.0.....0000©b.0",
    "..00.g0.0..¥...0",
    "b..0..0.0.¥¥.0.¥",
    "0000000.0.g..©.0",
    ".....0..0...©©.∫",
    ".00000.b©b.©©..0",
    ".0...0..∫..©..00",
    "0000.0.yyy.00.0.",
    "...˝........0000",
    "00.®®®0.000.0...",
    "0...®.0...000.g¥",
    "0.000.g.000....¥",
    "000.....0.0.y.¥¥",
    "0.000.gı0.000000"
    ],
    0, 15, "R",
    13, 4, "G",
    0,
    "The Nuclear Reactor",
    "Be Logical!");

//Level 79
newLevel([
    "˝˝¥ÁbÁ.ıry",
    "˝gı®ı0.¥ıg",
    "¥ı¥®00.¥0ı",
    "®®®®00.¥00",
    "®....0.y00",
    "©∫‰0.00.00",
    "®....00000",
    "®˝Á0000ııı",
    "ıb‰0...ır‰",
    "ıı®0000¥‰‰"
    ],
    8, 2, "B",
    3, 5, "R",
    "Or can you?",
    "mhogwarts",
    "You Can't Get To The Flag!");

//Level 80
newLevel([
    "000.0000.0000.000000",
    "..000.0.00.0..0.0..0",
    "0...00.00.0000..000.",
    "®®®..000.0.0.00000.0",
    "..®.00.00000..000.00",
    "®®®..0.....000..0000",
    "®...0..∫∫∫..0000..00",
    "®®®...∫∫.∫∫.....0..0",
    "..®.∫∫∫.y˝˝˝...000.0",
    "®®®.∫...ÁÁÁÁÁÁ...0.0",
    "®...∫∫∫∫∫∫∫∫∫ÁÁ¥.000",
    "®®®.........∫..¥.0.0",
    "..∫®®®®®®®®®®b.¥..00",
    "¥¥¥®........®..¥¥.0.",
    "¥...r¥.¥¥¥..®...¥.00",
    "¥¥¥.‰¥.¥.¥.®®.®.¥..0",
    "..¥.‰¥.¥.¥.®..®®0000",
    "¥¥¥.‰¥.¥.¥.®®®®.¥.gg",
    "¥...‰¥.¥.¥......¥.gg",
    "¥¥¥y‰¥¥¥.¥¥¥¥¥¥¥¥..."
    ],
    0, 0, "R",
    0, 2, "R",
    0,
    "Natth4545",
    "Cobra Cavern");

//Level 81
newLevel([
    "....................",
    ".0000000.Á000000000.",
    ".0...®.¥.g˝..0....0.",
    ".0.y.®.¥...Á.0.0000.",
    ".0.0®0000∫0Á.Á.0..©.",
    ".0.......0.Á.Á.0..r.",
    ".0®00.0000.ÁÁÁ.0....",
    ".0..0..0.......0.y0.",
    ".0..¥00ı0.‰y.‰©0..0.",
    ".0..0..ı..‰Á.‰.0©‰0.",
    ".0000.ıı.‰‰Á.‰.0©‰0.",
    ".0....ı..‰ÁÁ.‰.0..0.",
    ".0.bı.ı.Á00‰‰‰.0.b0.",
    ".0.Áı.ı.¥......0....",
    ".0®0ı.ı.¥.g.0000∫˝0.",
    "....ı.ı.¥.∫®®.....0.",
    ".®b.ııı.r.®®..0©©.0.",
    ".0......‰.ı.g...¥.0.",
    ".0000000000Á0000¥y0.",
    "...................."
    ],
    1, 1, "R",
    14, 16, "Y",
    0,
    "Tzirliya",
    "Square Maze");

//Level 82
newLevel([
    "...........",
    ".b∫ır‰.b‰g.",
    ".˝00ı0.‰0ı.",
    ".yı0˝0.00˝.",
    ".....©.0Áy.",
    ".g©0∫0®00Á.",
    ".ı00.Á.....",
    ".00∫.0˝ÁÁÁ.",
    ".00®.Á˝0˝Á.",
    ".0˝r.ÁÁÁ˝g.",
    "..........."
    ],
    5, 5, "G",
    5, 7, "G",
    "If you're unsure what to do next, scan the entire board for anything you may have missed!",
    0,
    "Pinwheel");

//Level 83
newLevel([
    "....................",
    "....................",
    "....................",
    "....................",
    "....................",
    "....................",
    "....................",
    "0∫g˝y0‰0.g‰0Á000Á000",
    "0...00.00˝00Á0Á0Á0Á0",
    "0∫r‰00˝0000000Á000Á0",
    "0....Á.............0",
    "00g000‰0y000˝00®00©0",
    "0000r0ı000b0Á00®00©0",
    "....................",
    "....................",
    "....................",
    "....................",
    "....................",
    "....................",
    "...................."
    ],
    0, 9, "R",
    7, 8, "Y",
    0,
    0,
    "The Hall of Doom");

//Level 84
newLevel([
    ".......ıgı0",
    "0∫®©¥000˝0∫",
    "¥.y...b00∫¥",
    "Á..˝©g.y˝.©",
    "rÁ¥y.b..®0‰",
    ".....˝..˝‰.",
    "r©˝g˝0˝r0©.",
    ".....˝..©˝.",
    "g˝¥b.y.y‰g.",
    "Á∫00.0.∫¥ı.",
    "...000˝b0¥."
    ],
    5, 6, "G",
    0, 1, "Y",
    0,
    "mhogwarts",
    "Crossroads");

//Level 85
newLevel([
    "yÁ©0.00®b.g˝¥˝b",
    "˝©¥0.Á00®.‰00¥ı",
    "©..0.yı®0.0ı00¥",
    "0000.ı0®Á.‰gı00",
    "˝00‰.0®Ár.0‰00‰",
    "g‰Á0.®00‰.000ır",
    "..0r.ı˝‰..ı‰Á..",
    "0©∫0‰∫©®‰¥∫0®‰y",
    "...0.ı˝‰...0...",
    ".ı00.000..Á0ÁÁ0",
    "0®˝‰...0..0‰0¥0",
    "00.0.r˝0∫.y0..0",
    "®000.‰0∫®.00.®0",
    "ı00ı.0∫®˝..0.®‰",
    "g˝‰b.∫®ıg..00Ár"
    ],
    11, 7, "R",
    0, 7, "Y",
    0,
    "mhogwarts",
    "The Passage");

//Level 86
newLevel([
    "g©©©¥∫˝b˝ıııı˝",
    "‰.¥˝∫¥˝ı˝ı˝©ı©",
    "r.y©¥b˝ııı˝©©ı",
    "˝.....˝˝˝˝˝˝˝ı",
    "©ııııı.....ııı",
    "©....ıııııı©®0",
    "©.g˝0000¥¥0Á00",
    "©.r0000y..00©0",
    "©..‰....¥¥....",
    "0∫©0bıg˝y¥00Ár",
    "0®......¥¥r0..",
    "0©.00......0Áb",
    "00000¥ÁÁbgr0..",
    "000.0¥gÁ0000Ág"
    ],
    3, 9, "R",
    3, 9, "Y",
    0,
    "mhogwarts",
    "You Lose If...");

//Level 87
newLevel([
    "0ÁÁÁÁÁÁÁÁÁÁÁÁÁÁÁıııy",
    "‰Áııı..........Áı˝˝ı",
    "‰Áı.ı..........Áı˝˝ı",
    "‰Áı.ıııııııııı.Áı˝˝ı",
    "‰Áı..........ı.Áı˝˝ı",
    "‰Áı....˝b©ıııı.Áı˝˝ı",
    "‰Áı....˝˝˝..ı..Áı˝˝ı",
    "‰Áı......˝..ı..Áı˝˝ı",
    "‰Áıııı.yÁ˝.0ııı0ıııı",
    "‰ÁÁÁÁıııÁ˝.˝...ÁÁÁÁ.",
    "‰‰‰‰ÁÁÁÁÁ˝˝˝˝˝˝˝˝˝¥0",
    "...‰‰‰‰‰‰‰‰‰‰‰‰‰‰®.0",
    "g0rÁÁÁÁÁ‰˝˝˝˝˝˝˝˝˝.0",
    "˝‰‰‰‰‰ÁÁ‰˝bııı˝....0",
    "˝˝˝˝˝‰Á‰‰˝˝˝˝ı˝....0",
    "‰‰‰‰©‰‰‰.‰‰g˝ı∫ııı.0",
    "‰...˝...‰‰ıııı˝....0",
    "‰...b...‰ı∫˝˝˝˝....g",
    "‰‰‰‰‰‰‰‰‰ı˝........˝",
    "..........˝˝r00000©0"
    ],
    0, 0, "R",
    19, 19, "G",
    "Sorry if it's laggy. ^_^",
    "Delta Knight (Toa Meltsner)",
    "Paths Laid Out");

//Level 88
newLevel([
    "˝˝˝˝˝˝˝˝˝˝....˝˝˝˝˝˝",
    "˝.˝......˝˝˝˝˝˝....˝",
    "˝.˝˝............˝˝˝˝",
    "˝..˝....˝˝˝r‰...˝...",
    "˝..˝ÁÁ.˝˝..‰‰ÁÁÁ¥ÁÁÁ",
    "˝.‰©yÁg˝..ÁÁ¥Á©©©˝˝Á",
    "˝.‰˝ÁÁ...ÁÁ.‰‰‰‰‰‰˝Á",
    "˝‰‰˝...ı.Á.Á¥ÁÁÁÁ‰˝Á",
    "r‰˝˝..ıı.Á.Á....Á‰˝Á",
    "˝˝˝...ı..0.Á.ÁÁÁÁ‰˝Á",
    ".....‰∫‰‰‰‰¥‰‰‰FÁ‰˝Á",
    "ıııı.‰ı..ÁÁÁ.ÁÁÁÁ‰˝Á",
    "ıır.‰‰ı.‰¥‰‰‰¥‰‰‰‰˝Á",
    "ıııır.ı.‰Á...ÁÁÁÁ.˝Á",
    "ııııııı.‰Á˝˝˝˝˝˝Á.˝Á",
    "......ı.‰Á¥ÁÁÁÁ˝Á.˝Á",
    ".ıııııı.‰.˝...Á˝Á.˝Á",
    ".ı......‰.˝ıb.Á˝Ág˝Á",
    ".ııııııı00©0‰.Á˝˝˝˝Á",
    "..............ÁÁÁÁÁÁ"
    ],
    9, 9, "Y",
    15, 10, "R",
    0,
    "Natth4545",
    "Paths Laid Out 2");

//Level 89
newLevel([
    "0‰‰‰‰Á‰‰‰..ııııııı",
    "‰‰‰Á‰Á‰‰‰..ıı‰‰‰‰ı",
    "ÁÁÁ‰‰Á‰‰.g˝.ı‰rı‰ı",
    "‰‰‰‰ÁÁ‰‰.ıı.ıı‰ı‰ı",
    "‰‰‰ÁÁ‰‰.ıııı.ııı‰ı",
    "‰ÁÁÁ‰‰‰.ı‰‰ı.y‰‰‰ı",
    "‰Á‰‰‰..ıı‰‰ıı.ıııı",
    "bı...ııı‰‰‰‰ııı..ı",
    ".ııııı‰‰‰ÁÁ‰‰‰ır‰.",
    "˝.‰‰‰‰‰ÁÁÁÁÁÁ‰‰‰.‰",
    "˝˝..yÁÁÁıııbÁb.‰‰‰",
    "˝˝˝˝..ııııııı.ııı‰",
    "˝ıı˝˝.ııı.ııı.ııg‰",
    "˝ııı˝˝g˝.0.˝g˝.‰ı‰",
    "˝ıyı.˝˝.yby.˝˝.‰‰‰",
    "˝ıı.˝˝.‰‰‰‰r.˝˝.‰‰",
    "˝ıb.r.bııııır˝˝.‰‰",
    "˝˝˝..˝˝˝˝˝˝˝˝˝..‰‰"
    ],
    0, 0, "R",
    9, 13, "B",
    0,
    "PigTornado",
    "Star Power");

//Level 90
newLevel([
    "....................",
    ".00000‰0000‰0000‰00.",
    ".0....0....0.©©.0...",
    ".0.rg.0.bı¥0.ıÁ.0®y.",
    ".0.‰˝.0.r‰¥0.by.0®r.",
    ".0.¥¥.0....0....0...",
    ".‰0000˝0000Á0000Á00.",
    ".0....0....0....0...",
    ".0.bı®0.gy.0©ıı.0.y.",
    ".0.yÁ®0.˝Á.0©Áy.0.∫.",
    ".0....0.®®.0....0.∫.",
    ".‰0000‰000000000ı00.",
    ".0....0....0.∫∫.0.∫.",
    ".0.‰y.0¥˝˝.0.˝‰.0.∫.",
    ".0.‰Á.0¥ıb.0.gr.0.g.",
    ".0.©©.0....0....0...",
    ".‰00000000000000000.",
    ".0....0....0.∫∫.∫...",
    ".0.˝©©0.‰®®0.bb.©¥0.",
    "...................."
    ],
    1, 1, "R",
    18, 18, "W",
    0,
    "Tzirliya",
    "Horseshoes");

//Level 91
newLevel([
    "...................0",
    ".0r‰0yÁ00Á00Á00ı0r.0",
    ".g0‰00Á0rÁ00Á00ı00.0",
    ".˝˝.‰‰.‰‰.ÁÁ.ıı.‰‰.0",
    ".00ı0gı00‰00‰0b˝00˝0",
    ".0bı00ı00‰00‰00˝00˝0",
    ".˝˝.˝˝.‰‰.ÁÁ.˝˝.‰‰.0",
    ".00‰00˝00ıb0‰00˝g0.0",
    ".00‰r0˝00ı00‰00˝00.0",
    ".˝˝.‰‰.ıı.‰‰.‰‰.ÁÁ.0",
    ".00ı00˝00˝0rı00˝0y.0",
    ".00ı00˝00˝00ıy0˝00.0",
    ".ıı.ıı.˝˝.‰‰.ÁÁ.ıÁ.0",
    ".00Áb0Á00Á00˝0bı00.0",
    ".0yÁ00Á00Á00˝00ı00.0",
    ".‰‰.ıı.˝˝.ÁÁ.˝˝.ÁÁ.0",
    ".00‰00˝00‰00‰00ı00ı0",
    ".00‰0g˝00‰00‰00ı0bı0",
    ".‰‰................0",
    "r0000000000000000000"
    ],
    1, 1, "R",
    19, 0, "B",
    0,
    "Evan Thomas",
    "The Maze Runner");

//Level 92
newLevel([
    "0‰Á¥ÁÁÁ.˝˝˝˝˝©©®g...",
    ".‰®.Ág¥˝˝....‰.b000.",
    ".®®.ÁÁÁ.˝bııır....0.",
    ".®®.............∫00.",
    ".®®.˝∫∫∫∫∫∫∫∫∫∫∫∫...",
    ".®®.©............000",
    ".®..©.¥¥¥¥ı.g.Á000.0",
    ".®.©©.¥..Á∫.¥.y....0",
    ".®.©..∫∫.Á∫.¥.˝˝...0",
    ".®.©...∫.Á∫.¥¥˝˝bı.0",
    "y®.©©©©∫.Á∫.¥.˝˝.0.0",
    "...©.....∫∫.¥.r..0.0",
    "©©©©.y.y.r..¥.‰.0000",
    "©....©.®‰‰‰‰Á.000...",
    "©.©©©©.ÁÁÁÁÁÁ...0.∫®",
    "©.©...........000.∫®",
    "©©©.00000000000...∫®",
    "©...¥.............∫®",
    "©.‰¥¥¥¥¥¥¥¥r......∫∫",
    "b˝g˝¥¥¥¥¥¥¥¥¥¥¥¥¥¥®0"
    ],
    0, 0, "R",
    19, 19, "G",
    0,
    "Mr Dollywaggit",
    "Tower Escape");

//Level 93
newLevel([
    "r©∫0˝000˝0.00.¥®0®00",
    "©∫˝000.0©000.00¥0¥0®",
    "∫00000000.0000.0®0®0",
    "000˝.0˝0˝0000.00®00¥",
    "∫0˝0000˝0000000.0®¥0",
    "0˝000.00.00000.00.0®",
    "000˝000.00000000.00.",
    "0.0000˝00000000000.0",
    "000˝˝.00∫∫∫00000000.",
    "0ı.0000∫©©©∫0000000.",
    ".00000∫©®®®©∫00000.0",
    "000000∫©®y®©∫0000.0.",
    "000000∫©®®®©∫0.0.0.0",
    "0000000∫©©©∫00.0000∫",
    "00000000∫∫∫0.00..∫00",
    "0000000000000.0000.0",
    "00000000000.000∫.00∫",
    "0000000000∫0.0.00∫00",
    "0000000000000∫00.00∫",
    "000000000.0.∫0∫∫0∫0g"
    ],
    0, 19, "B",
    19, 0, "Y",
    "What's the least amount of moves required for this one?",
    "Goldsplash", "Big Adventure");

//Level 94
newLevel([
    "r‰00Á000©00.",
    "Á00®˝©¥0Á∫∫.",
    "ı00®0.‰.®®∫.",
    "bÁ0®0Á0˝∫¥0.",
    "‰‰‰∫∫.©.®Á∫.",
    "...∫∫.¥.‰yı.",
    "˝g.∫∫.®.∫Á®.",
    "®Á.∫∫.0.0000",
    "®®‰∫∫.ı.0ı‰Á",
    "®®.∫∫˝b..000",
    "∫∫.∫∫Ár‰r0ı0",
    "∫∫®∫∫ıı..‰bÁ"
    ],
    6, 7, "B",
    6, 3, "B",
    0,
    "mhogwarts", "Clear The Path!");

//Level 95
newLevel([
    "..0©0000............",
    "..0....0®¥..........",
    "..0.r0©0.¥©0¥000¥0..",
    "..0....0..©0.....0..",
    "..0.gÁ©0®.˝......0..",
    "..0.®©®0®¥©˝.....0..",
    "..0.y0˝0®.˝y˝b00Á0..",
    "..0........˝...b....",
    "..0‰000.0000...∫....",
    "..©...00..0.00.00...",
    "..©0©..000000.000...",
    "..0®0®.∫∫∫∫®.00.....",
    "....©.r∫0∫0®00.0....",
    "..0©0©0∫0∫0∫.∫∫®00..",
    "..©....∫000®0∫0®.0..",
    "..0.g®®∫0.0∫0∫®∫r0..",
    "..©...¥.0.00.®0..0..",
    "..00000r.0.00®.y00..",
    "..00000y.........¥..",
    "..0000000000000000.."
    ],
    2, 0, "R",
    17, 2, "B",
    0,
    "Max",
    "The Gamemaster");

//Level 96
newLevel([
    "0¥∫‰‰‰‰‰‰0˝˝‰‰‰‰‰‰‰‰",
    "¥00.ııııı‰.˝‰ıııııb‰",
    "000˝0˝0˝00˝˝‰˝˝˝˝0˝‰",
    "ı.Á.ıÁı.ı‰ı˝‰‰‰‰˝ı˝‰",
    "ıÁÁÁ0Áı.ı0ı0ııı‰˝ı˝‰",
    "ıÁııı0‰‰‰‰‰0‰0ı‰˝ı˝‰",
    "ıÁı..˝0˝˝˝˝00˝˝0˝ı˝‰",
    "ı0ı.yı0ııııı‰..‰˝ı˝‰",
    "Á0‰‰0‰‰‰‰ı‰‰‰‰‰‰˝ı˝‰",
    "Áı‰ÁÁııı0ı‰ııııııı˝‰",
    "Áı‰Á‰‰0‰‰ı‰ı‰‰‰.‰‰0‰",
    "Áı‰ÁÁ0Áııııı‰˝0˝0˝˝‰",
    "Áı‰‰Á‰‰.‰‰‰‰‰˝‰Á‰˝‰‰",
    "ÁııÁÁÁ‰r˝˝˝˝˝˝‰Á‰˝˝‰",
    "Áı‰Á‰Á‰0‰‰‰‰‰‰‰Á‰‰˝˝",
    "Áı‰Á‰Á0ÁÁÁÁÁÁÁÁÁÁ‰‰˝",
    "00‰Á‰Á‰˝˝˝˝˝˝˝˝˝0˝‰0",
    "‰Á‰‰‰‰‰˝ÁÁÁÁÁ‰‰‰Á˝˝0",
    "‰ÁÁÁÁÁÁÁÁ‰‰‰ÁÁÁÁÁÁÁ‰",
    "‰‰‰‰‰‰‰‰‰‰g‰‰‰‰‰‰‰‰‰"
    ],
    1, 1, "G",
    0, 0, "R",
    0,
    0,
    "Spaghetti");

//Level 97
newLevel([
    "....................",
    "...y0000............",
    "...®...Á............",
    ".00©‰∫©®0˝˝˝®00¥b...",
    ".0.‰∫©®00ııı®000ı...",
    ".0.∫©®00.ÁÁÁ.0.00...",
    ".0.©®000.Á.ÁÁ‰.00...",
    ".0..0.0Á0b0.Á0‰0....",
    ".0.0Áı0Ár000.Ár0y...",
    ".0.0˝00.0000.ÁÁ0©...",
    ".0.0‰0.000Á0....®...",
    ".0.0..000‰0ı.0000...",
    ".0.0..Á...g..0..0...",
    ".0.0ı000000Á0r0‰˝...",
    ".0.0‰0®0r00..‰0‰0...",
    ".0.∫r.˝...Á.00‰0∫...",
    ".0.0˝y0000©Áb∫0®g...",
    ".0..0...............",
    ".0000...............",
    "...................."
    ],
    3, 16, "B",
    3, 16, "Y",
    "Don't give up!",
    0,
    "Two Secret Tunnels");

//Level 98
newLevel([
    "00‰0ı000∫Á∫¥©©Á.0000",
    "0˝00.˝0.0.∫˝Á000¥©Á0",
    "0‰Á000‰00‰0.0ı.0©ı0¥",
    "∫00ı0.00ı.∫Á0.00‰0¥˝",
    "0Á‰.Á∫©Á¥00.0©0Á.¥.0",
    "¥ı0g.‰.g‰.®ı0..0®∫00",
    "¥©0.000.®0.0Á.∫‰0˝00",
    "∫b..Á.00˝0©00‰∫0ı0ı.",
    "0g000‰r.0®.‰Á00.©Á00",
    "Á¥ı©.0ı0∫¥‰00Á0˝00‰0",
    ".®Á0®∫˝Á.00Á0.ı00ı.r",
    "y0.0ı0∫0©00.0Á®©.000",
    "00‰0.0¥00¥˝0©0.∫0ı˝0",
    "®˝0.y‰0.ı˝0‰.¥0˝.00g",
    "∫0©Á¥0.0©0.0®ı000.00",
    "©0®0.00Á˝0®0˝rÁ0ı.ı0",
    "ı.0¥0®0‰0‰Áı000.0r0.",
    "00‰Á0g00.00®∫‰Á00˝00",
    "0gı0®0ı®¥ı0∫.0¥0ı0Á0",
    "000‰00.∫00Á0˝0.0˝000"
    ],
    3, 10, "R",
    10, 2, "G",
    "This looks real fun.", 0, "Your Path Is Clear");

//Level 99
newLevel([
    "g©000000000000000000",
    "Á0Á................¥",
    "0ı.0Ág00¥0.0‰g˝®©y.®",
    "0.0y.˝0¥00∫00‰00.Á00",
    "0.0.Á0Á.ı.0.ı.000.00",
    "0.®0©˝.00‰©r00.0000ı",
    "0.‰ry.000.0.000.00˝©",
    "0.g˝.0000.0.0000.‰0®",
    "0.¥0∫000.˝0˝.000∫000",
    "0.0ı.®..00Á00..0.000",
    "0..0Á00‰00000®b∫0¥..",
    "0.00.˝..00F00..¥.00ı",
    "0.¥ı0000.000.000ı0‰0",
    "0.©¥.0000.®.0000.‰ı0",
    "0.˝00.000.˝.000.00ı‰",
    "0.˝000.00ı0∫00.0®0ı‰",
    "0.0.00Á.®.©.ı.0y0.0r",
    "0.00.˝0000g‰¥Á0‰.0©0",
    "0..00ı¥˝00.ı0‰Á0Á©.0",
    "0∫0©Á∫¥000.yı0‰©00Ág"
    ],
    10, 11, "G",
    10, 11, "Y",
    "You're almost done! Keep it up!",
    0,
    "It's A Small World After All");

//Level 100
newLevel([
    ".......................",
    ".0y‰00Á0‰©0©0©¥0©00‰¥0.",
    ".0ı0Á‰r¥®Á∫gyı®‰Áı˝0b0.",
    ".®0∫00ı∫0ı0‰0˝0ı©00®0˝.",
    ".ı...................∫.",
    ".000000000000000000000.",
    ".0˝˝˝0˝˝000˝00˝˝000˝˝0.",
    ".00˝00˝0˝0˝0˝0˝0˝0˝000.",
    ".00˝00˝0˝0˝˝˝0˝0˝00˝00.",
    ".00˝00˝˝00˝0˝0˝0˝000˝0.",
    ".00˝00˝0˝0˝0˝0˝0˝0˝˝00.",
    ".000000000000000000000.",
    ".‰‰0ÁÁÁ0ı000‰‰‰0ÁÁ000ıı",
    "‰000Á0Á0ı000‰0r0Á0Á0ı0.",
    "‰000Á0Á0ı000‰0‰0Á0Á00b.",
    "‰000y0Á0ı000‰0‰0ÁÁ0000ı",
    ".‰‰0ÁÁÁ0ııı0‰‰‰0Á0Á0ıı.",
    ".000000000000000000000.",
    ".ı...‰...Á...ı...‰...˝.",
    ".®ı¥Á0ı©®0˝0∫®00∫0®Á0¥.",
    ".‰0®000∫‰0Áı00Á0‰0ı0‰∫.",
    ".0©0˝0‰Á0¥®0Á˝®0Á0˝∫00.",
    "......................."
    ],
    1, 1, "B",
    1, 21, "B",
    0, 0, "The 100th Level!");

/**Deprecated Levels

//Level 1
newLevel([
    "000000000000",
    "...........0",
    "0000000000.0",
    "0........0.0",
    "0........0.0",
    "0........0.0",
    "0.....0000.0",
    "0..........0",
    "0..........0",
    "0..........0",
    "0..........0",
    "000000000000",
    ],
    0, 0, 0,
    6, 6, 0,
    "Get me to the flag. Use the arrow keys!",
    0, "Smiley's Quest");

//Level 4
newLevel([
    "00.........000000...",
    "0000000000.0....0...",
    "00.......0.0..0.0...",
    ".0.......0.0..0.0...",
    ".0......00.0..0.0...",
    ".0......00.0..0.0...",
    ".0....0000.0..0.0...",
    ".0.00.0....0..0.0.0.",
    ".0..0.000000..0.0.0.",
    ".0..0...0.....0.0.0.",
    ".0..000.0.....0.0.0.",
    ".0....0.0.....000.0.",
    ".0.0..0.00000.0.0.0.",
    ".0.0.00.....0.0.0000",
    ".0.0.00000000.0....0",
    ".0.0..........0....0",
    ".0.000000000000....0",
    ".0................00",
    ".0................00",
    ".00000000000000000.0"
    ],
    0, 0, 0,
    19, 19, 0,
    0,
    "summitwei", "The Maze");

//Level 9
newLevel([
    ".......",
    "r0b....",
    ".0.....",
    ".0000©0",
    ".0.....",
    "y0g....",
    "......."
    ],
    1, 3, "B",
    6, 3, "B",
    "Oh no! This barrier is blocking my path! Destroy it somehow!",
    0, "Blocked!");

//Level 9
newLevel([
    "..............",
    ".......000.000",
    "...¥0000.0.0.0",
    "0000...0.r.0.0",
    "..0....0...0.0",
    "..y....0...0.0",
    ".......0.000.©",
    "....g..®.0...∫",
    "....0000.0...®",
    ".......0©∫...¥",
    ".........0...0",
    ".........00..0",
    "..........b..0",
    ".............0"
    ],
    0, 3, "R",
    13, 13, "Y",
    0, "Delta Knight (Toa Meltsner)");

//Level 10
newLevel([
    "..............",
    "..g...........",
    "..0...........",
    "..00r.........",
    "..0...........",
    "..0...........",
    "000000...000¥0",
    ".....00000....",
    ".......©......",
    ".......0......",
    ".......0......",
    "......000.....",
    "......y.b.....",
    ".............."
    ],
    0, 6, "R",
    13, 6, "B",
    0,
    0, "Branches");

//Level 10
newLevel([
    "0000000000.0",
    ".........0.0",
    "00000g00.0.0",
    "0....0...0.0",
    "0.00000000.0",
    "0.....b....0",
    "000000000000",
    "......˝.....",
    "......˝.....",
    "000000000000",
    "0.....0.....",
    "r.....0‰0000",
    ],
    0, 0, "B",
    11, 11, "R",
    0, "Agentdroid");


//Level 17
newLevel([
    "000000000",
    "........0",
    "0000000.0",
    "0...g...0",
    "0.0000000",
    "0....b...",
    "000000000",
    ".....˝...",
    "r00000‰00",
    ],
    0, 0, "B",
    8, 8, "R",
    "Gates open if you match their color, and close otherwise.",
    "The Portal Pro");

//Level 18
newLevel([
    ".....",
    ".0®g.",
    ".˝...",
    ".y¥0.",
    "....."
    ],
    1, 1, "R",
    3, 3, "Y",
    "It'll get harder, don't worry.", "Anonymous", "Too Easy");

//Level 19
newLevel([
    "............˝F˝.....",
    ".00000000000˝˝˝.....",
    ".ııııııııı©.........",
    ".¥¥¥¥¥¥¥¥y©.........",
    ".r00000000©.........",
    ".‰‰‰‰‰‰‰‰‰©‰‰‰‰‰‰‰‰.",
    ".......0©©©b00......",
    ".......000‰b00......",
    ".˝˝˝˝˝˝˝˝˝©ıııııııı.",
    ".rrrrrrrrr©®rrrrrrr.",
    "...........®........",
    "...........000000®®b",
    ".r¥000000000..¥®∫¥®.",
    ".......0..0..¥®∫¥®∫.",
    ".....000..0.¥®∫¥®∫¥.",
    "...000....0¥®∫¥®∫¥®.",
    ".y∫0......¥®∫¥®∫¥®∫.",
    ".........¥®∫¥®∫¥®∫¥.",
    "........¥®∫¥®∫¥®∫¥®g",
    "...................."
    ],
    1, 1, "B",
    13, 0, "G",
    0, "20183740");

//Level 20
newLevel([
    "ııııı",
    "ı‰‰‰0",
    "ı‰.y∫",
    "ı‰‰.∫",
    "0.b∫∫"
    ],
    4, 1, "R",
    0, 4, "B",
    0, "PigTornado", "Loop de' Loop");

//Level 24
newLevel([
    "....00....",
    "....00....",
    "....00....",
    "0000000000",
    "r..y..g..b",
    "0..0..0..0",
    "0..0..0..0",
    "ı..‰..˝..Á",
    "0000000000",
    "....00....",
    ],
    4, 0, "R",
    5, 9, "W",
    0, 0, "Lantern");

//Level 25
newLevel([
    ".............",
    ".∫∫00g000000.",
    ".©©..........",
    ".0g0˝........",
    ".ı..˝......0.",
    ".ı..˝˝˝˝...¥.",
    ".ı.....˝...¥.",
    ".ı.....˝...¥.",
    ".ııı0ııb...¥.",
    ".......0¥¥.¥.",
    ".........¥.¥.",
    ".........¥¥¥.",
    "............."
    ],
    11, 4, "Y",
    11, 1, "G",
    0,
    " ");

//Level 30
newLevel([
    "0©000®0",
    "©y©0®g®",
    "0©000®0",
    "0000000",
    "0∫000¥¥",
    "∫r∫0¥˝˝",
    "0∫00.b0"
    ],
    3, 3, "B",
    6, 6, "B",
    0,
    "~Makena~", 0);

//Level 31
newLevel([
    "..........",
    "...0...˝g.",
    "...0...˝ı.",
    ".bı000000.",
    ".0‰0....0.",
    "........0.",
    ".0˝000000.",
    ".yÁ0...r®.",
    "........0.",
    ".........."
    ],
    3, 1, "R",
    8, 8, "Y",
    0, "The Portal Pro", "Gates");

//Level 32
newLevel([
    "rı00000Áy",
    "˝0000000ı",
    "00.000.00",
    "000000000",
    "0000.0000",
    "0.00000.0",
    "0‰.000.‰¥",
    "00‰.˝.˝00",
    "00r‰g˝rÁ0"
    ],
    4, 0, "B",
    0, 3, "G",
    0, "PigTornado", "Evil Smiley");

//Level 40
newLevel([
    "yı0Áyı.00000",
    "‰000‰0¥00˝00",
    "000000.0ırı0",
    "00000ı.00Á00",
    "0000˝y.00000",
    "ı......0000Á",
    "b˝˝˝˝0.000ır",
    "ı......0000˝",
    "0000ır.00ı00",
    "00000‰.0˝rÁ0",
    "‰00000¥00‰00",
    "y˝Á000.00000"
    ],
    5, 6, "G",
    7, 6, "R",
    0,
    "PigTornado", "Booby Traps!");

//Level 53
newLevel([
    "000",
    "000",
    "000"
    ],
    0, 0, 0,
    2, 2, 0,
    "The LAST LEVEL... (Dun dun DUUUUUN!)",
    0,
    "Smile! :)");
*/

var numLevels = levels.length - 1;
var numCustomLevels = customLevels.length - 1;

var instantiateArray = function(arr) {
    var arrinst = [];
    for(var aCount = 0; aCount < arr.length; aCount++) {
        arrinst.push(arr[aCount]);
    }
    return arrinst;
};

//The level object currently loaded.
var level;

//Current Level
var currentLevel;
if(!currentLevel){
    currentLevel = 1;
}

//Stats used for the level
var currentStats = {
    moves: 0,
    time: 0.000
};

var debugMode = false;


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                       Grid Functions                       *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var getTileAt = function(x, y){
    if(level.data[y][x]){
        return level.data[y][x];
    }
};

var characterOnTile = function(){
    return getTileAt(level.me.pos.x, level.me.pos.y);
};

var tileLeftOfCharacter = function(){
    return getTileAt(level.me.pos.x - 1, level.me.pos.y);
};

var tileRightOfCharacter = function(){
    return getTileAt(level.me.pos.x + 1, level.me.pos.y);
};

var tileAboveCharacter = function(){
    return getTileAt(level.me.pos.x, level.me.pos.y - 1);
};

var tileBelowCharacter = function(){
    return getTileAt(level.me.pos.x, level.me.pos.y + 1);
};

var translateToGridCoords = function(coords){
    translate((coords.x + 0.5) * level.tileSize, (coords.y + 0.5) * level.tileSize);
};

var reverseTranslateToGridCoords = function(coords){
    translate((-coords.x - 0.5) * level.tileSize, (-coords.y - 0.5) * level.tileSize);
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                       Color Functions                      *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var randomHue = function(a, s, b){
    if(!s){s = 0;}
    if(!b){b = 255;}
    var randomHueValues = [s, b, random(s, b)];
    var fillColor = [0, 0, 0];
    for(var i = 0; i < 3; i++){
        var randomIndex = floor(random(0, randomHueValues.length));
        var randomValue = randomHueValues[randomIndex];
        randomHueValues.splice(randomIndex, 1);
        fillColor[i] = randomValue;
    }
    
    a = a ? a : 300;
    return color(fillColor[0], fillColor[1], fillColor[2], a);
};

//var colSwitchCount = 0;

var savedBackgroundColor;

var randomizeBackgroundColor = function(){
    savedBackgroundColor = randomHue(150);
};

var colorByLetter = function(letter, opacity){
    if(!opacity){ opacity = 300; }
    switch(letter){
        case "R": return color(230, 113, 118, opacity);
        case "Y": return color(242, 238, 114, opacity);
        case "G": return color(131, 178, 111, opacity);
        case "B": return color(129, 186, 217, opacity);
        default: return color(255, 255, 255);
        /*
        case "R": return color(255, 0, 0, opacity);
        case "Y": return color(255, 255, 0, opacity);
        case "G": return color(0, 255, 0, opacity);
        case "B": return color(0, 255, 255, opacity);
        */
    }
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                      Button Functions                      *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

//Account for scaled canvas – use these instead of mouseX and mouseY
var scaledMouseX;
var scaledMouseY;

//Called in mouseMoved()
var scaleMouse = function(){
    scaledMouseX = mouseX * 400 / canvasSize;
    scaledMouseY = mouseY * 400 / canvasSize;
};

var mouseOverRect = function(x, y, w, h){
    return scaledMouseX > x && scaledMouseY > y &&
           scaledMouseX < x + w && scaledMouseY < y + h;
};

var buttons = [];

var mouseOverButton;
var mouseOverMessageButton = false;

var invisibleButton = function(x, y, w, h, t, isMessage, isTextBox, isSwitchButton){
    //Submit a button only if not already
    var b = {x: x, y: y, w: w, h: h, t: t, isMessage: isMessage, isTextBox: isTextBox, isSwitchButton: isSwitchButton};
    var buttonAlreadyPushed = false;
    for(var i = 0; i < buttons.length; i++){
        if(b.x === buttons[i].x && b.y === buttons[i].y &&
        b.w === buttons[i].w && b.h === buttons[i].h &&
        b.t === buttons[i].t){
            buttonAlreadyPushed = true;
            break;
        }
    }
    if(!buttonAlreadyPushed){buttons.push(b);}
};

var ibtn = invisibleButton;

var button = function(x, y, w, h, t, tS, f, s, tF, r, sW, mOF, mOTF, mOS, isSwitchButton, switchButtonBool){
    //Set optional parameters if unspecified
    //Transparent White
    f = f ? f : color(255, 255, 255, 50);
    //Opaque White
    s = s ? (s === 1 ? randomHue(150, 250) : s)
          : color(255, 255, 255);
    //Stroke weight
    sW = sW ? sW : 3;
    //Radius of rect
    r = r ? r : 5;
    //Almost-transparent white
    mOF = mOF ? mOF : color(255, 255, 255, 250);
    //Opaque White
    mOS = mOS ? mOS : color(255, 255, 255);
    
    var mouseIsOverButton = t === mouseOverButton;
    
    //Rect
    fill(mouseIsOverButton ? mOF : f);
    stroke(mouseIsOverButton ? mOS : s);
    strokeWeight(sW);
    rect(x, y, w, h, r);
    
    //Set optional parameters if unspecified
    //White
    tF = tF ? tF : color(255, 255, 255);
    //Black
    mOTF = mOTF ? mOTF : color(0, 0, 0);
    
    //Text
    fill(mouseIsOverButton ? mOTF : tF);
    stroke(mouseIsOverButton ? mOTF : tF);
    textAlign(CENTER, CENTER);
    textSize(tS);
    text(isSwitchButton ? (switchButtonBool ? "ON" : "OFF") : t, x + w / 2, y + h / 2);
    
    ibtn(x, y, w, h, t, undefined, undefined, isSwitchButton);
};

var btn = button;

var mouseOverSwitchButton = false;

var switchButton = function(x, y, w, h, id, bool, txtSize){
    txtSize = txtSize ? txtSize : 10;
    btn(x, y, w, h,
        id, txtSize,
        undefined,
        bool ? color(8, 242, 47) : color(245, 10, 45),
        color(255, 255, 255),
        undefined, undefined, undefined,
        bool ? color(8, 242, 47) : color(245, 10, 45),
        bool ? color(8, 242, 47) : color(245, 10, 45), true, bool);
};//x, y, w, h, t, tS, f, s, tF, r, sW, mOF, mOTF, mOS

var sbtn = switchButton;

/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                          Text Box                          *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var textBoxes = [];

var mouseOverTextBox;
var selectedTextBox;

var textBox = function(x, y, w, h, id, txt, txtSize){
    fill(255, 255, 255, 200);
    noStroke();
    rect(x, y, w, h);
    
    fill(0);
    textSize(txtSize ? txtSize : 16);
    textAlign(LEFT, CENTER);
    text(txt, x + 3, y + h / 2);
    
    //Editor line blinks 15 out of every 30 frames
    if(id === selectedTextBox && frameCount % 30 < 15){
        stroke(0);
        strokeWeight(2);
        line(x + textWidth(txt) + 4, y + 3, x + textWidth(txt) + 4, y + h - 3);
    }
    
    ibtn(x, y, w, h, id, false, true);
    
    //Submit a text box only if not already
    var textBoxAlredyPushed = false;
    for(var i = 0; i < textBoxes.length; i++){
        if(id === textBoxes[i]){
            textBoxAlredyPushed = true;
            break;
        }
    }
    
    if(!textBoxAlredyPushed){textBoxes.push(id);}
};

var tBox = textBox;

var checkIfMouseOverButton = function(){mouseOverButton = undefined;
    mouseOverMessageButton = undefined;
    mouseOverTextBox = undefined;
    mouseOverSwitchButton = undefined;
    for(var f = buttons.length - 1; f >= 0; f--){
        if(mouseOverRect(buttons[f].x, buttons[f].y,
                         buttons[f].w, buttons[f].h)){
            mouseOverButton = buttons[f].t;
            mouseOverMessageButton = buttons[f].isMessage;
            mouseOverTextBox = buttons[f].isTextBox;
            mouseOverSwitchButton = buttons[f].isSwitchButton;
            break;
        }
    }
};

var clearButtonsAndTextBoxes = function(){
    buttons = [];
    textBoxes = [];
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                           Icons                            *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var pauseIcon = function(x, y, s){
    translate(x, y);
    scale(s, s);
    
    stroke(255);
    strokeWeight(3);
    line(-3.5, 6, -3.5, -6);
    line(3.5, 6, 3.5, -6);
    
    scale(1/s, 1/s);
    translate(-x, -y);
};

var restartIcon = function(x, y, s){
    translate(x, y);
    scale(s, s);
    
    noFill();
    stroke(255);
    strokeWeight(3);
    arc(0, 0, 12, 12, -207, 90);
    line(-0.5, 6, 1.5, 2);
    line(-0.5, 6, 3.5, 6.5);
    
    scale(1/s, 1/s);
    translate(-x, -y);
};

var arrow = function(x, y, l, a, w, h){
    pushMatrix();
    translate(x, y);
    rotate(a);
    line(0, 0, 0, -l);
    triangle(0, -l, -w, -l + h, w, -l + h);
    popMatrix();
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                   Transform Animation                      *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var transformCircles = [];
var transformCircleDistance = 40;
var transformCircleSizeSpeed = 15;
var transformCircleInitialAlpha = 100;
var transformCircleFadeSpeed = 1.5;

var clearTransformCircles = function(){
    transformCircles = [];
};

var transformCircle = function(position, ccolor, size, basedOnGrid, isLast){
    transformCircles.push({
        pos: position ? position : vec(scaledMouseX, scaledMouseY),
        color: ccolor ? ccolor : randomHue(),
        alpha: transformCircleInitialAlpha,
        size: size ? size : 0,
        lastCircleInASequence: isLast,
        basedOnGrid: basedOnGrid
    });
};

var numberOfCirclesInTransformAnimation = 5;

var newTransformAnimation = function(from, to){
    if(!game.betterPerformance){
        for(var i = 0; i < numberOfCirclesInTransformAnimation; i ++){
            transformCircle(vec(level.me.pos.x, level.me.pos.y), lerpColor(from, to, i / (numberOfCirclesInTransformAnimation - 1)), i * -transformCircleDistance, true, i === numberOfCirclesInTransformAnimation - 1);
        }
    }
};

var drawAndUpdateTransformCircles = function(generateRandom){
    if(generateRandom){
        if(floor(random(0, 25)) === floor(random(0, 25))){
            transformCircle(vec(random(-200, 600), random(-200, 600)), randomHue(), true);
        }
    }
    
    noStroke();
    for(var i = 0; i < transformCircles.length; i++){
        var circle = transformCircles[i];
        
        if(circle.basedOnGrid){
            translateToGridCoords(circle.pos);
        }else{
            translate(circle.pos.x, circle.pos.y);
        }
        
        if(circle.lastCircleInASequence){
            fill(red(circle.color), green(circle.color), blue(circle.color), circle.alpha / 2);
        }else{
            noFill();
        }
        strokeWeight(transformCircleDistance);
        stroke(red(circle.color), green(circle.color), blue(circle.color), circle.alpha);
        ellipse(0, 0, max(0, circle.size), max(0, circle.size));
        
        if(circle.basedOnGrid){
            reverseTranslateToGridCoords(circle.pos);
        }else{
            translate(-circle.pos.x, -circle.pos.y);
        }
    }
    
    var i = 0;
    
    while(i < transformCircles.length){
        transformCircles[i].alpha -= transformCircleFadeSpeed;
        transformCircles[i].size += transformCircleSizeSpeed;
        
        if(transformCircles[i].alpha <= 1){
            transformCircles.splice(i, 1);
        }else{
            i++;
        }
    }
};

/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                           Smiley                           *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var winText = round(random(0, winMessage.length));
var textRot = random(-25, 25);

var smileyTopLeft;

var smiley = function(colorID, directionID){
    fill(colorByLetter(colorID));
    stroke(50);
    strokeWeight(32);
    ellipse(0, 0, 360, 360);
    
    noFill();
    stroke(50);
    strokeWeight(40);
    switch(directionID){
        case "W":
            point(-80, -50);
            point(10, -50);
            strokeWeight(20);
            arc(-20, 0, 200, 200, 30, 145);
            break;
        case "E":
            point(-10, -50);
            point(80, -50);
            strokeWeight(20);
            arc(20, 0, 200, 200, 35, 150);
            break;
        case "N":
            point(-50, -75);
            point(50, -75);
            strokeWeight(20);
            arc(0, -30, 200, 200, 35, 145);
            break;
        case "S":
            point(-50, -25);
            point(50, -25);
            strokeWeight(20);
            arc(0, 15, 220, 200, 35, 145);
            break;
        case "☺":
            line(-100, -40, -60, -80);
            line(-20, -40, -60, -80);
            line(20, -40, 60, -80);
            line(100, -40, 60, -80);
            fill(50);
            strokeWeight(1);
            arc(0, 20, 220, 200, 0, 180);
            break;
        default:
            point(-50, -50);
            point(50, -50);
            strokeWeight(20);
            arc(0, 0, 220, 200, 35, 145);
    }
};

var finish = function(colorID){
    noFill();
    if(colorID === "W"){
        colorMode(HSB);
        stroke((frameCount * 2) % 255, 150, 200);
    }else{
        stroke(colorByLetter(colorID));
    }
    strokeWeight(40);
    strokeCap(SQUARE);
    
    quad(-80, 160, -80, -140, 100, -60, -80, 20);
    
    strokeCap(ROUND);
    
    colorMode(RGB);
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                           Scene                            *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var currentScene = "title";
var previousScenes = [];

var newScene;
var switchingScene = false;
var toDoWhenDone;
var restarting = false;

var previousScene = function(){
    return previousScenes[previousScenes.length - 1];
};

var previousSceneIsPauseMenu = false;
var previousSceneIsCreateLevelMenu = false;

var sCA = {
    //Animation Frame
    aF: 0,
    initialCAlpha: 100,
    circleAlpha: 100, //Must be same as initialCAlpha
    sceneChangesAt: 37,
    sceneChangesNow: false,
    fadeOutAt: 40,
    fadeSpeed: 8,
    animationEndsNow: false
};

var sceneChangeAnimation = function(){
    //Ellipse Size
    var eSz;
    
    noStroke();
    for(var i = 0; i < 12; i++){
        fill([
            color(255, 0, 0, sCA.circleAlpha),
            color(255, 127, 0, sCA.circleAlpha),
            color(255, 255, 0, sCA.circleAlpha),
            color(127, 255, 0, sCA.circleAlpha),
            color(0, 255, 0, sCA.circleAlpha),
            color(0, 255, 127, sCA.circleAlpha),
            color(0, 255, 255, sCA.circleAlpha),
            color(0, 127, 255, sCA.circleAlpha),
            color(0, 0, 255, sCA.circleAlpha),
            color(127, 0, 255, sCA.circleAlpha),
            color(255, 0, 255, sCA.circleAlpha),
            color(255, 0, 127, sCA.circleAlpha)
        ][i]);
        
        eSz = max(sCA.aF - i * 2, 0);
        ellipse(200, 200, pow(eSz, 2), pow(eSz, 2));
    }
    
    if(restarting){
        //(1/3)x^2-20x+300
        restartIcon(200, 200,
            pow(sCA.aF, 2) / 3 - 20 * sCA.aF + 302);
    }
    
    sCA.circleAlpha = min(
        100 + (sCA.fadeOutAt - sCA.aF) * sCA.fadeSpeed,
        sCA.initialCAlpha);
    
    sCA.sceneChangesNow = sCA.aF === sCA.sceneChangesAt;
    sCA.animationEndsNow = sCA.circleAlpha <= 0;
        
    sCA.aF++;
};

var PREVIOUS = 1;

//NEVER set currentScene. Instead call this function.
//scene: string of the scene to set currentScene to.
//can be set to PREVIOUS – sets the scen to the previous scene
var switchScene = function(scene, animate, doWhenDone, restart){
    if(!switchingScene){
        sCA.aF = 0;
        if(scene === PREVIOUS){
            scene = previousScenes.pop();
        }else{
            previousScenes.push(currentScene);
        }
        newScene = scene;
        switchingScene = animate;
        toDoWhenDone = doWhenDone;
        restarting = restart;
    }
    
    sceneChangeAnimation();
    
    //Wait for notification to change scene at the right time
    if(sCA.sceneChangesNow || animate !== true){
        currentScene = newScene;
        selectedTextBox = undefined;
        if(animate){
            clearTransformCircles();
        }
        if(toDoWhenDone){
            toDoWhenDone();
        }
    }
    
    if(sCA.animationEndsNow || animate !== true){
        switchingScene = false;
        restarting = false;
    }
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                           Footer                           *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var footer = function(){
    textSize(10);
    textAlign(LEFT, CENTER);
    text("Version " + version, 5, 390);
    textAlign(RIGHT, CENTER);
    text("Transcolors Copyright © 2013-2015 DY. All rights reserved.", 395, 390);
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                       Message System                       *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var message = {
    enabled: false,
    text: "",
    timer: undefined,
    displayTime: 250,
    alpha: 0,
    fadeSpeed: undefined,
    fadeOut: true,
    height: undefined,
    textSize: undefined,
    //lines: !!,
    button: undefined,
    fadeToAlpha: 200,
};

/*
var messageOn = false;
var messageText = "";

var messageTimer;
var messageDisplayTime = 250;
var messageAlpha = 0;
var messageFadeSpeed;
var messageFadesOut = true;

var messageHeight;
var messageTextSize;
//var messageLines; !!
var messageButton;
*/

//Runs only if messageOn
var displayMessage = function(newMessageText, time, boxHeight, buttonText, txtSize, fadeToAlpha){
    if(newMessageText){
        message.enabled = true;
        message.text = newMessageText;
        message.timer = 0;
        message.fadeToAlpha = fadeToAlpha || 200;
        if(time){
            message.fadeOut = true;
            message.displayTime = time;
        }else{
            message.fadeOut = false;
            message.displayTime = 100;
        }
        //message.alpha = 0;
        if(message.displayTime >= 100){
            //Use 10 frames to fade in and out
            message.fadeSpeed = message.fadeToAlpha / 10;
        }else{
            //Use 1/10 of the time to fade in and out
            message.fadeSpeed = message.fadeToAlpha / (message.displayTime / 10);
        }
        
        message.textSize = txtSize ? txtSize : 15;
        //message.lines = lines ? lines : 1; !!
        //message.height = boxHeight ? boxHeight : txtSize * lines + 35;
        message.height = boxHeight ? boxHeight : message.textSize * 1 + 45;
        
        message.button = buttonText;
    }
    
    //Fade in during first 10, out during last 10
    if(message.timer < 10){
        message.alpha = min(message.alpha + message.fadeSpeed, message.fadeToAlpha);
    }else if(message.timer > message.displayTime - 10 && message.fadeOut){
        message.alpha = max(message.alpha - message.fadeSpeed, 0);
    }
    
    var topOfMessage = 400 - message.height;
    
    fill(255, 255, 255, message.alpha);
    noStroke();
    rect(0, 400, 400, -message.height);
    
    //Progress Bar
    if(message.fadeOut){
        fill(255, 255, 255, message.alpha);
        fill(180, 180, 180, message.alpha);
        rect(0, 397, 400 * message.timer / message.displayTime, 3);
        //arc(389, topOfMessage + 12, 21, 21, -90, 360 * message.timer / message.displayTime - 90);
    }
    
    fill(0, 0, 0, message.alpha);
    textAlign(CENTER, CENTER);
    textSize(message.textSize);
    //Margin of 10
    text(message.text, 10, topOfMessage, 380, message.height);
    
    message.timer++;
    
    //If the display time was set to 0, the message won't
    //disappear (until the X button is clicked)
    //if(message.timer >= message.displayTime && messageFadeOut){
    if(message.alpha <= 0 && message.fadeOut){
        message.enabled = false;
    }
    
    if(message.button){
        ibtn(0, topOfMessage, 400, message.height, message.button, true);
    }
    
    btn(382, topOfMessage + 5, 13, 13,
        "⊗", 0,
        color(0, 0, 0, 200 * max(min(message.alpha, 300), 1)/300),
        color(255, 255, 255, 0),
        color(255, 255, 255, message.alpha));
    noFill();
    strokeWeight(2);
    ellipse(389, topOfMessage + 12, 15, 15);
    line(386, topOfMessage + 9, 392, topOfMessage + 15);
    line(386, topOfMessage + 15, 392, topOfMessage + 9);
};

/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                          DY Logo                           *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var DY1 = function(x, y, sz){
    translate(x, y);scale(sz, sz);noStroke();fill(255);rect(0, 0, 400, 400, 30);fill(0, 174, 255, 50);rect(0, 0, 400, 400);fill(212, 89, 208);triangle(249, 200, 200, 125, 200, 275);strokeWeight(6);fill(84, 194, 109);stroke(158, 38, 38);bezier(50, 50, 275, 60, 275, 340, 50, 350);line(50, 51, 50, 349);strokeWeight(5);stroke(81, 81, 173);line(150, 50, 248, 197);line(350, 50, 250, 200);line(150, 350, 250, 200);noStroke();fill(255, 208, 66, 150);triangle(170, 50, 330, 50, 250, 170);fill(255, 188, 117, 150);triangle(350, 70, 170, 350, 350, 350);scale(1/sz, 1/sz);translate(-x, -y);
};

var DY2 = function(x, y, s){
    var nHH=12.5;var yW=16;pushMatrix();translate(x,y);scale(s/400);rectMode(CENTER);fill(255);rect(0,0,400,400,30);fill(0,174,255,50);stroke(224,255,244);strokeWeight(20);noStroke();rect(-0.5,-0.5,400,400,20);rectMode(CORNER);noFill();pushMatrix();translate(-140,0);scale(10);stroke(0,174,255);strokeWeight(1);line(0,-nHH,0,nHH);arc(0,0.5,26,26,-90,90);popMatrix();translate(10,0);scale(28/3);stroke(255,183,74);strokeWeight(4);line(-2,-nHH,yW/2-2,2);line(yW-2,-nHH,yW/2-2,2);line(yW/2-2,nHH,yW/2-2,2);popMatrix();
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                       Splash Screen                        *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

//New Logo! Toggle for the old look.
var classicLogo = true;

var splashTime = 100;

var splash = function(){
    clearButtonsAndTextBoxes();
    clearTransformCircles();
    
    fill(255);
    noStroke();
    rect(0, 0, 400, 400);
    
    fill(200);
    rect(0, 0, frameCount * 400 / splashTime, 5);
    
    fill(0);
    textAlign(CENTER, CENTER);
    textSize(25);
    text("Created by", 200, 60);
    if(classicLogo){
        DY1(100, 90, 1/2);
    }else{
        DY2(200, 190, 200);
    }
    
    fill(150);
    textSize(15);
    text("Good luck, and enjoy the game!", 200, 340);
    
    fill(0);
    footer();
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                           Title                            *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var titleLetter = function(){
    return {
        hue: random(0, 255),
        hueSpeed: random(0, 5),
        hueSpeedSpeed: random(0, 0.5),
        hueSpeedIncreasing: round(random(0, 1)) === 0
    };
};

var titleLetters = [];
for(var i = 0; i < 6; i++){
    titleLetters.push(titleLetter());
}

var drawTitle = function(){
    textSize(64);
    
    var betweenTransAndColors = 200 - textWidth("Transcolors") / 2 + textWidth("Trans");
    
    fill(255);
    textAlign(RIGHT, CENTER);
    text("Trans", betweenTransAndColors, 52.5);
    
    colorMode(HSB);
    
    textAlign(LEFT, CENTER);
    
    var COLORS = "colors";
    
    for(var i = 0; i < titleLetters.length; i++){
        fill((titleLetters[i].hue % 255), 200, 255);
        text(COLORS[i], betweenTransAndColors + textWidth(COLORS.slice(0, i)), 52.5);
        
        titleLetters[i].hue += titleLetters[i].hueSpeed;
        if((titleLetters[i].hueSpeed >= 5 && titleLetters[i].hueSpeedIncreasing) ||
            (titleLetters[i].hueSpeed <= 0 && !titleLetters[i].hueSpeedIncreasing)){
            titleLetters[i].hueSpeedIncreasing = !titleLetters[i].hueSpeedIncreasing;
        }
        titleLetters[i].hueSpeed += titleLetters[i].hueSpeedIncreasing ? titleLetters[i].hueSpeedSpeed : -titleLetters[i].hueSpeedSpeed;
    }
    
    colorMode(RGB);
};

var title = function(){
    drawAndUpdateTransformCircles(true);
    
    btn(15, 15, 370, 75,
        "Announcements", 0,
        color(0, 0, 0, 1), color(0, 0, 0, 1), undefined, 5, undefined,
        color(255, 255, 255, 150), undefined, color(0, 0, 0, 1));
    drawTitle();
    
    fill(255);
    textSize(40);
    textAlign(RIGHT, TOP);
    text("by", 195, 100);
    
    if(mouseOverRect(210, 100, 50, 50)){
        btn(207, 97, 55, 55,
            "DY", 0);
    }
    
    //DY Logo
    if(classicLogo){
        DY1(210, 100, 1/8);
    }else{
        DY2(235, 125, 50);
    }
    
    btn(20, 115, 50, 25,
        "LINKS", 12,
        0, 1);
    
    pushMatrix();
    translate(0, sin(frameCount * 3) * 10);
        
        fill(240);
        textAlign(CENTER, CENTER);
        
        translate(65, 200);
        rotate(sin(frameCount * 10) * 5);
            
            textSize(15);
            text(numLevels + " LEVELS!", 0, 0);
            
        rotate(-sin(frameCount * 10) * 5);
        translate(-65, -200);
        
    translate(0, sin(frameCount * 3) * -10);
    
    translate(0, sin(frameCount * 3) * -10);
        
        translate(335, 200);
        rotate(cos(frameCount * 10) * -5);
            
            textSize(10);
            text("App development\nunderway!", 0, 0);
            
        rotate(cos(frameCount * 10) * 5);
        translate(-335, -200);
        
    translate(0, sin(frameCount * 3) * 10);

    translate(330, 125);
    rotate(20);
        textSize(14);
        text("Announcements\n& FAQ", 0, 0);
    rotate(-20);
    translate(-330, -125);
    
    popMatrix();
    
    noFill();
    stroke(200);
    strokeWeight(1);
    arc(300, 95, 100, 100, -10, 20);
    
    fill(0, 255, 0);
    strokeWeight(3);
    
    colorMode(HSB);
    btn(120, 170/* + sin(frameCount * 6) * 3*/, 160, 60,
        "START", 38,
        color(frameCount % 255, 150, 200),
        color(0, 0, 255, 150),
        color(0, 0, 255), undefined, undefined,
        color(0, 0, 255),
        color(frameCount % 255, 255, 255),
        color(frameCount % 255, 255, 255));
    colorMode(RGB);
    
    btn(20, 250, 170, 42,
        "Level Select", 24, color(146, 0, 194), 1);
    btn(210, 250, 170, 42,
        "Save Game", 24, color(255, 183, 0), 1);
    btn(20, 310, 170, 42,
        "Create a Level", 23, color(0, 194, 155), 1);
    btn(210, 310, 170, 42,
        "Settings", 24, color(143, 143, 143), 1);
    
    fill(255);
    footer();
};

//////////////////////////////////////////////////////////////

//true = regular level, false = custom level
var playingRegularLevel = true;

var typeOfLevel = function(){
    return playingRegularLevel ? "Level " : "Custom Level ";
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                          Level Won                         *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var winCounter = 0;
var winCounterChanging = false;
var newBest = {moves: false, time: false};

var winLevel = function(){
    if(playingRegularLevel){
        if(!game.stats[currentLevel]){
            game.stats[currentLevel] = {
                moves: currentStats.moves,
                time: currentStats.time
            };
            newBest.moves = true;
            newBest.time = true;
        }else{
            if(currentStats.moves < game.stats[currentLevel].moves){
                newBest.moves = true;
            }
            if(currentStats.time < game.stats[currentLevel].time){
                newBest.time = true;
            }
            game.stats[currentLevel] = {
                moves: min(game.stats[currentLevel].moves, currentStats.moves),
                time: min(game.stats[currentLevel].time, currentStats.time)
            };
        }
    }
    
    translateToGridCoords(level.me.pos);
    
    //Winning Animation
    if(currentScene === "win"){
        for(var rot = 0; rot < 16; rot++){
            rotate(45/2);
            if(game.flashingColors){
                stroke(random(0,255),random(0,255),random(0,255));
            }else{
                stroke(255);
            }
            strokeWeight(winCounter/10 + 1);
            line(winCounter * 4, 0, winCounter * 3.5, 0);
        }
    }

    //Victory Message
    if(currentScene === "win"){
        rotate(textRot);
            fill(colorByLetter(level.me.color, -2 * winCounter + 300));
            textAlign(CENTER, CENTER);
            //textSize(min(winCounter ^ 3, 225));
            textSize(50);
            
            text(winMessage[winText], 0, 0);
        rotate(-textRot);
    }
    
    reverseTranslateToGridCoords(level.me.pos);
    
    //Disable buttons underneath
    clearButtonsAndTextBoxes();
    
    //filter(BLUR, 2);
    
    fill(savedBackgroundColor);
    noStroke();
    rect(0, 0, 399, 399);
    
    //Level Cleared
    fill(255, 255, 255, winCounter * 2.5);
    textSize(55);
    textAlign(CENTER, CENTER);
    if(playingRegularLevel){
        text("Level Cleared", 200, 140);
    }else{
        text("Custom Level", 200, 105);
        text("Cleared", 200, 160);
    }
    
    //Stats for the level
    textSize(24);
    textAlign(LEFT, CENTER);
    text("Moves: " + currentStats.moves, 50, 350);
    textAlign(RIGHT, CENTER);
    text("Time: " + currentStats.time, 350, 350);
    
    fill(220);
    textSize(14);
    textAlign(LEFT, CENTER);
    if(newBest.moves){text("Ne" + "w Best!", 50, 330);}
    textAlign(RIGHT, CENTER);
    if(newBest.time){text("Ne" + "w Best!", 350, 330);}
    
    fill(220);
    textSize(10);
    textAlign(LEFT, CENTER);
    text("SPACE", 45, 200);
    textAlign(RIGHT, CENTER);
    text("RETURN/ENTER︎", 355, 200);
    
    btn(45, 210, 150, 40,
        "Replay Level", 24);
    btn(205, 210, 150, 40,
        currentLevel === numLevels ?
        "Create a Level" : (playingRegularLevel ? "Next Level" : "Edit Level"), 22);
    btn(120, 260, 160, 40,
        "Main Menu", 24);
    
    if(winCounter < 1000){winCounter += 4;}
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                         Pause Menu                         *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var pauseMenu = function(){
    //filter(BLUR, 1);
    clearButtonsAndTextBoxes();
    fill(84);
    noStroke();
    rect(0, 380, 400, 20);
    fill(savedBackgroundColor);
    //stroke(colorByLetter(level.me.color));
    rect(0, 0, 400, 400);
    
    fill(0, 255, 0);
    strokeWeight(3);
    btn(90, 170, 220, 60,
        "Main Menu", 38, color(0, 255, 0), 1, color(0, 0, 0));
    btn(20, 250, 170, 42,
        "Level Select",
        24,
        color(146, 0, 194), 1);
    btn(210, 250, 170, 42,
        playingRegularLevel ? "Save Game" : "Edit Level",
        playingRegularLevel ? 24 : 23,
        playingRegularLevel ? color(255, 183, 0) : color(0, 194, 155), 1);
    btn(115, 310, 170, 40,
        "Settings", 24, color(143, 143, 143), 1);
    
    btn(smileyTopLeft ? 340 : 5, 5, 55, 25,
        "BACK", 14,
        color(0), 1, color(255));
    
    pauseIcon(200, 85, 5);
    
    fill(255);
    footer();
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                       Replace Square                       *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var replaceSquare = function(x, y, replaceWith){
    var row = "";
    for(var i = 0; i < level.size; i++){
        if(i === x){
            row += replaceWith;
        }else{
            row += level.data[y][i];
        }
    }
    level.data[y] = row;
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                Draw Elements and Animations                *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

//wallAnimationData
var wADX = [], wADY = [], wADXC = [], wADYC = [];
var aWX, aWY, aWC, aWO;

var resetWallAnimation = function(){
    for(var c6 = 2; c6 < 20; c6 += 2){
        wADX[c6]=[];wADY[c6]=[];wADXC[c6]=[]; wADYC[c6] = [];
        for(var c7 = 2; c7 < 20; c7 += 2){
            wADX[c6][c7] = 0; wADY[c6][c7] = 0;
            wADXC[c6][c7] = random(-10, 10);
            wADYC[c6][c7] = random(-10, 10);
        }
    }
    aWX = level.me.pos.x;
    aWY = level.me.pos.y;
    aWC = level.me.color;
    aWO = 200;
};

//resetWallAnimation();

var animateWall = function(){
    translate(aWX * 20, aWY * 20);
        noStroke();
        fill(colorByLetter(aWC, aWO));
        for(var c = 2; c < 20; c += 2){
            for(var d = 2; d < 20; d+=2){
                if((c+d)%4===0){
                    rect(wADX[c][d]+c,wADY[c][d] + d, 2, 2);
                    wADX[c][d] += wADXC[c][d];
                    wADY[c][d] += wADYC[c][d];
                }
            }
        }
        aWO -= 3;
    translate(aWX * -20, aWY * -20);
};

var drawTile = function(){
    rectMode(CENTER);
    rect(0, 0, 400, 400);
    rectMode(CORNER);
};

var drawBreakableBrick = function(color){
    fill(colorByLetter(color, 200));
    drawTile();
    fill(colorByLetter(color));
    //fill(255, 255, 255, 100);
    noStroke();
    for(var x = -1; x <= 1; x++){
        for(var y = -1; y <= 1; y++){
            ellipse(x * 400 / 3, y * 400 / 3, 75, 75);
        }
    }
};

var gatePush = {
    r: 450,
    y: 450,
    g: 450,
    b: 450
};
var gateSpeed = 20;

var getGatePush = function(color){
    switch(color){
        case "R": return gatePush.r;
        case "Y": return gatePush.y;
        case "G": return gatePush.g;
        case "B": return gatePush.b;
    }
};

var setGatePush = function(color, setTo){
    switch(color){
        case "R": gatePush.r = setTo; break;
        case "Y": gatePush.y = setTo; break;
        case "G": gatePush.g = setTo; break;
        case "B": gatePush.b = setTo; break;
    }
};

var gateOpen = 250;
var gateClosed = 450;

var drawGate = function(color){
    if(level.me.color === color){
        setGatePush(color, max(getGatePush(color) - gateSpeed, gateOpen));
    }else{
        setGatePush(color, min(getGatePush(color) + gateSpeed, gateClosed));
    }
    
    fill(colorByLetter(color));
    noStroke();
    arc(-200, -200, getGatePush(color), getGatePush(color), 0, 90);
    arc(200, -200, getGatePush(color), getGatePush(color), 90, 180);
    arc(-200, 200, getGatePush(color), getGatePush(color), -90, 0);
    arc(200, 200, getGatePush(color), getGatePush(color), 180, 270);
};

var drawGrid = function(grid){
    for(var x = 0; x < level.size; x++){
        for(var y = 0; y < level.size; y++){
            var tile = grid[y][x];
            translateToGridCoords(vec(x, y));
            scale(level.tileSize / 400, level.tileSize / 400);
            
            fill(80);
            stroke(54, 54, 54, 50);
            strokeWeight(1);
            
            switch(tile){
                case "0":
                    noFill();
                    scale(400 / level.tileSize, 400 / level.tileSize);
                    rectMode(CENTER);
                    rect(0, 0, level.tileSize, level.tileSize);
                    rectMode(CORNER);
                    scale(level.tileSize / 400, level.tileSize / 400);
                    break;
                case ".":
                    var b = game.barrierBrightness * 10 + 4;
                    fill(b, b, b, 200);
                    noStroke();
                    drawTile();
                    break;
                case "r":
                    //1/8 chance of blinking
                    //if(frameCount % 15 > 3){
                    fill(floor(random(0, 8.999)) % 8 > 0 ? colorByLetter("R") :
                        color(80, 80, 80, 200));
                    drawTile();
                    break;
                case "y":
                    fill(floor(random(0, 8.999)) % 8 > 0 ? colorByLetter("Y") :
                        color(80, 80, 80, 200));
                    drawTile();
                    break;
                case "g":
                    fill(floor(random(0, 8.999)) % 8 > 0 ? colorByLetter("G") :
                        color(80, 80, 80, 200));
                    drawTile();
                    break;
                case "b":
                    fill(floor(random(0, 8.999)) % 8 > 0 ? colorByLetter("B") :
                        color(80, 80, 80, 200));
                    drawTile();
                    break;
                case "®"://Red Wall
                    drawBreakableBrick("R");
                    break;
                case "¥"://Yellow Wall
                    drawBreakableBrick("Y");
                    break;
                case "©"://Green Wall
                    drawBreakableBrick("G");
                    break;
                case "∫"://Blue Wall
                    drawBreakableBrick("B");
                    break;
                case "‰"://Red Gate
                    drawGate("R");
                    break;
                case "Á"://Yellow Gate
                    drawGate("Y");
                    break;
                case "˝"://Green Gate
                    drawGate("G");
                    break;
                case "ı"://Blue Gate
                    drawGate("B");
                    break;
            }
            if(debugMode){
                textAlign(CENTER, CENTER);
                fill(200);
                textSize(150);
                text(tile, 0, 0);
            }
            scale(400 / level.tileSize, 400 / level.tileSize);
            reverseTranslateToGridCoords(vec(x, y));
        }
    }
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                       Level Tutorial                       *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

/*
var tutorial = function(){
    fill(colorByLetter(level.me.color));
    stroke(colorByLetter(level.me.color));
    textAlign(CENTER, CENTER);
    textSize(15);
    strokeWeight(4);
    strokeCap(PROJECT);
    switch(currentLevel){
        case 1:
            text("Get to the flag!", 210, 246);
            //text("Get to the flag!", 290, 326);
            line(210, 227, 210, 237);
            noStroke();
            triangle(204, 229, 216, 229, 210, 223);
            break;
        case 4:
            text("Use these to transform into the correct color.", 170, 355);
            line(170, 250, 170, 345);
            noStroke();
            triangle(164, 250, 176, 250, 170, 244);
            break;
        case 7:
            text("Oh no! A wall is blocking your way!\nGet rid of it by matching colors!", 250, 260);
            line(250, 210, 250, 240);
            noStroke();
            triangle(244, 210, 256, 210, 250, 204);
            break;
        case 10:
            text("Gates open only if you match its color.", 150, 50);
            line(52, 62, 52, 250);
            line(52, 252, 89, 252);
            text("This level can be finished with any color.", 210, 350);
            line(210, 310, 210, 340);
            noStroke();
            triangle(90, 246, 90, 258, 96, 252);
            triangle(204, 310, 216, 310, 210, 304);
            break;
        case 17:
            text("If you ever get stuck, you can\nalways press the restart button!", 110, 70);
            text("(Not this one.)", 340, 340);
            line(18, 50, 18, 40);
            line(368, 370, 368, 355);
            noStroke();
            triangle(12, 38, 24, 38, 18, 32);
            triangle(362, 372, 374, 372, 368, 378);
            break;
        case 20:
            if(level.me.pos.y !== 0){
                fill(92, 92, 92, 100);
                noStroke();
                rect(226, 4, 171, 13);
            }
            break;
        case 21:
            if(level.me.pos.y !== 0){
                fill(92, 92, 92, 100);
                noStroke();
                rect(306, 4, 91, 13);
            }
            break;
    }
    strokeCap(ROUND);
};
*/


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                            Level                           *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var levelStartAtMillis;

var levelRunning = false;

var startMessages = [
    "Go!",
    "Good Luck!",
    "Let's do this!",
    "Go for it!",
    "You can do it!",
    "Start!",
    "May the force be with you!"
];
var startMessage;

var countingDown = false;
var count;
var count2;
var countAlpha;
var countDuration = 0.7;
var countdownStartedAt;
var countdownTimeElapsed;

var resetLevel = function(){
    levelRunning = false;
    countingDown = false;
    
    var newLevel;
    
    //Reset all level data
    if(playingRegularLevel){
        newLevel = levels[currentLevel];
    }else{
        newLevel = customLevels[currentLevel];
    }
    
    //If start color equals finish color...
    var startAndFinishColor = randomColor();
    
    level = {
        data: [],
        size: max(newLevel.data.length, newLevel.data[0].length),
        tileSize: 400 / newLevel.size,
        me: {
            pos: vec(newLevel.start.pos.x, newLevel.start.pos.y),
            color: newLevel.startColorEqualsFinishColor ? startAndFinishColor :
                newLevel.start.color,
            direction: ""
        },
        finish: {
            pos: newLevel.finish.pos,
            color: newLevel.startColorEqualsFinishColor ? startAndFinishColor
                : newLevel.finish.color
        },
        tutorial: newLevel.tutorial,
        author: newLevel.author,
        title: newLevel.title
    };
    
    //Initialize grid
    if(playingRegularLevel){
        level.data = instantiateArray(newLevel.data);
    }else{
        level.data = instantiateArray(newLevel.data);
    }
    
    //Change background color for pause screen
    randomizeBackgroundColor();
    
    currentStats.moves = 0;
    
    newBest = {moves: false, time: false};
    
    //Don't advance win animation
    winCounterChanging = false;
};

var startCountdown = function(){
    if(!levelRunning && currentScene === "level" && !mouseOverButton && !countingDown){
        countdownStartedAt = millis();// - 3000;
        countingDown = true;
        startMessage = startMessages[floor(random(0, startMessages.length-0.001))];
    }
};

var startLevel = function(){
    //Run just once every time
    if(!levelRunning){
        levelRunning = true;
        levelStartAtMillis = millis();
        
        //Tutorial
        if(playingRegularLevel){
            displayMessage(level.tutorial, 200, undefined, "⊗");
        }
    }
};

//resetLevel();

var playLevel = function(){
    if(currentScene === "level"){
        currentStats.time = (millis()-levelStartAtMillis)/1000;
    }
    
    countdownTimeElapsed = (millis() - countdownStartedAt) / 1000;
    count = 3 - floor(countdownTimeElapsed / countDuration);
    count2 = countdownTimeElapsed % 1;
    countAlpha = 300 - (countdownTimeElapsed % countDuration) / countDuration * 300;
    
    if(countingDown && count === 0){
        startLevel();
    }
    
    if(levelRunning){
        drawGrid(level.data);
    }
    
    //Draw Finish
    translateToGridCoords(level.finish.pos);
    scale(level.tileSize / 400, level.tileSize / 400);
        
        fill(colorByLetter(level.finish.color));
        stroke(colorByLetter(level.finish.color));
        
        finish(level.finish.color);
        
        //Press mouse on grid to spotlight finish
        if(mouseIsPressed && currentScene === "level" && !mouseOverButton &&
            levelRunning && scaledMouseX <= 400){
            noFill();
            stroke(0, 0, 0, 150);
            strokeWeight(10000);
            ellipse(10, 10, 12000, 12000);
        }
        
    scale(400 / level.tileSize, 400 / level.tileSize);
    reverseTranslateToGridCoords(level.finish.pos);
    
    //Draw Transform Circles
    if(!game.betterPerformance){
        drawAndUpdateTransformCircles();
    }
    
    //Draw Smiley
    translateToGridCoords(level.me.pos);
    translate(0.5, 0.5);
    scale(level.tileSize / 400, level.tileSize / 400);
        
        smiley(level.me.color, currentScene === "win" ? "☺": level.me.direction);
        
    scale(400 / level.tileSize, 400 / level.tileSize);
    translate(-0.5, -0.5);
    reverseTranslateToGridCoords(level.me.pos);
    
    //animateWall(level.me.pos.x, level.me.pos.y, level.me.color);
    
    //Check if finished
    if(level.me.pos.isEqual(level.finish.pos) && (level.me.color === level.finish.color || level.finish.color === "W")){
        if(!restarting && !switchingScene && currentScene === "level"){
            switchScene("win");
            if(currentLevel === numLevels){
                displayMessage("Congatulations! You beat the game! Awesome! Kudos to you for toughing it out! (If you skipped here via the Level Select, good for you - you know how to cheat!)\n\nIf you are interested, I am making this game for the App Store. See updates at darryl-yeo.com/transcolors-app.\n\nI encourage you to go back and beat your own scores - complete each level in as FEW moves as possible. It's quite a challenge, but it forces you to look for shortcuts, and the game suddenly becomes a whole new puzzle!\n\nSince you must be a master at this game by now, help me out and expand this game by making your own levels! Click anywhere to get started!", 0, 400, "Create a Level", 16, 240);
            }
        }
        if(!winCounterChanging){
            textRot = random(-25, 25);
            winText = round(random(0, winMessage.length));
            winCounter = 0;
            winCounterChanging = true;
        }
    }
    
    //Countdown!
    //Different events happen depending on whether the level
    //is in play and when the countdown is counting down.
    if(!countingDown && !levelRunning && currentScene === "level"){
        fill(0, 0, 0, 100);
        noStroke();
        rect(0, 0, 400, 400);
        
        fill(255);
        textAlign(CENTER, CENTER);
        textSize(playingRegularLevel ? 65 : 45);
        text(typeOfLevel() + currentLevel, 200, 110);
        
        textSize(20);
        textAlign(CENTER, TOP);
        if(level.author === "Anonymous"){
            textFont(createFont(game.font + " Italic"));
        }
        text((level.title ? level.title + "\n" : "") + "by " + level.author, 200, 145);
        textFont(createFont(game.font));

        if(playingRegularLevel && game.stats[currentLevel]){
            textSize(17);
            textAlign(CENTER, CENTER);
            text("Best Moves", 125, 240);
            text("Best Time", 275, 240);
            
            textSize(20);
            text(game.stats[currentLevel].moves, 125, 265);
            text(game.stats[currentLevel].time, 275, 265);
        }
        
        fill(255, 255, 255, (sin(frameCount * 6) + 1) * 250);
        textAlign(CENTER, CENTER);
        textSize(20);
        text("Click to start!", 200, 325);
        fill(200, 200, 200, (sin(frameCount * 6) + 1) * 250);
        textSize(12);
        text("(Or use SPACE or arrow keys)", 200, 350);
        
        fill(220);
        stroke(220);
        strokeWeight(1);
        textSize(10);
        if(smileyTopLeft){
            textAlign(RIGHT, CENTER);
            text("SPACE", 320, 20);
            arrow(324, 20, 10, 90, 3, 4);
            text("RETURN/ENTER", 390, 58);
            arrow(382.5, 48, 10, 0, 3, 4);
        }else{
            textAlign(LEFT, CENTER);
            text("RETURN/ENTER", 83, 20);
            arrow(78, 20, 10, -90, 3, 4);
            text("SPACE", 10, 58);
            arrow(17.5, 48, 10, 0, 3, 4);
        }
    }
    
    if(countingDown && !levelRunning){
        fill(255, 255, 255, countAlpha / 4);
        noStroke();
        rect(0, 0, 400, 400);
    }
    
    if(countingDown){
        textAlign(CENTER, CENTER);
        
        fill(255, 255, 255, countAlpha);
        if(count === 0){
            /*†
            textSize(settings.bestPerformance ?
                pow(count2, 2) * 100 :
                30);
            */
            textSize(30);
            text(startMessage, 200, 200);
        }else if(count > 0){
            /*†
            textSize(settings.bestPerformance ?
                pow(count2, 2) * 1000 :
                250);
            */
            textSize(250);
            text(count, 200, 200);
        }else{
            countingDown = false;
        }
    }
    
    //Display Text
    if(levelRunning){
        //Text (hidden if level won)
        if(currentScene === "level"){
            //Top Text
            //Fade if character is at the top
            fill(255, 255, 255,
                (level.me.pos.y === 0 && !smileyTopLeft) ?
                100 : 300);
            textSize(10);
            textAlign(RIGHT, CENTER);
            text((level.title ? '"' + level.title + '"'
                : "Level") + " by " + level.author,
                395, smileyTopLeft ? 42 : 10);
                
            //Bottom Text
            //Fade if character is at the bottom
            fill(255, 255, 255,
                level.me.pos.y === level.size - 1 ? 100 : 300);
            textAlign(LEFT, CENTER);
            textSize(10);
            text("Moves: " + currentStats.moves, 5, 390);
            text("Time: " + (levelRunning ? currentStats.time : "0.000"), 145, 390);
            
            if(playingRegularLevel){
                text(game.stats[currentLevel] ? "Best: " + game.stats[currentLevel].moves : "Best: N/A", 75, 390);
                text("Best Time: " + (game.stats[currentLevel] ? game.stats[currentLevel].time : "N/A"), 235, 390);
            }
            
            textAlign(RIGHT, CENTER);
            text(typeOfLevel() + currentLevel, 395, 390);
        }
    }

    //If Smiley goes to the top left corner, move buttons
    smileyTopLeft = level.me.pos.x < 4 && level.me.pos.y < 2;
    
    if(currentScene === "level"){
        //Restart Button
        btn(smileyTopLeft ? 340 : 5, 5, 25, 25,
            "Replay Level", 0,
            color(255, 255, 255, 120),
            color(255, 255, 255, 120));
        
        restartIcon(smileyTopLeft ? 352.5 : 17.5, 17.5);
        
        //Pause Button
        btn(smileyTopLeft ? 370 : 35, 5, 25, 25,
            "Pause Level", 0,
            color(255, 255, 255, 120),
            color(255, 255, 255, 120));
        
        pauseIcon(smileyTopLeft ? 382.5 : 47.5, 17.5);
    }
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                        Level Select                        *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var levelPage = 0;
var totalLevelPages = function(){
    return floor((playingRegularLevel ? numLevels : numCustomLevels) / 48);
};

var levelSelect = function(){
    numCustomLevels = customLevels.length - 1;
    
    if(previousSceneIsPauseMenu){
        playLevel();
        fill(savedBackgroundColor);
        noStroke();
        rect(0, 0, 400, 400);
    }else if(currentScene === "createLevel"){
        fill(savedBackgroundColor);
        noStroke();
        rect(0, 0, 400, 400);
    }else{
        drawAndUpdateTransformCircles(true);
    }
    
    fill(255);
    textAlign(CENTER, CENTER);
    if(typeof mouseOverButton === "number"){
        textSize(17);
        if(playingRegularLevel){
            text(levels[mouseOverButton].title ? levels[mouseOverButton].title : "Level " + mouseOverButton, 200, 20);
            text("by " + levels[mouseOverButton].author, 200, 40);
        }else{
            text(customLevels[mouseOverButton].title ? customLevels[mouseOverButton].title : "Level " + mouseOverButton, 200, 20);
            text("by " + customLevels[mouseOverButton].author, 200, 40);
        }
    }else{
        textSize(playingRegularLevel ? 32 : 30);
        text(typeOfLevel() + "Select", 200, 30);
    }
    
    fill(255, 255, 255, 50);
    noStroke();
    //rect(0, 55, 400, 290);
    
    //Margin
    var m = 14;
    //Square Size
    var s = 36;
    //Space Between Squares
    var b = 48;
    //Buttons
    for(var x = 0; x < 8; x++){
        for(var y = 1; y < 7; y++){
            var levelNum = (x + 1) + (y - 1) * 8 + levelPage * 48;
            if(levelNum <= numLevels && playingRegularLevel){
                btn(x * b + m, y * b + m, s, s,
                    levelNum, 15,
                    game.stats[levelNum] ? color(255, 255, 255, 150) : 0,
                    game.stats[levelNum] ? color(255, 255, 255, 200) : 0);
            }else if(levelNum <= numCustomLevels && !playingRegularLevel){
                btn(x * b + m, y * b + m, s, s,
                    levelNum, 15);
            }else if(levelNum === numCustomLevels + 1 && currentScene === "createLevel"){
                btn(x * b + m, y * b + m, s, s,
                    "+", 18,
                    color(255, 255, 255, 150),
                    color(220, 220, 220, 150));
            }else{
                fill(255, 255, 255, 50);
                noStroke();
                rect(x * b + m, y * b + m, s, s, 5);
            }
        }
    }

    //mouseOverButton
    fill(255);
    textSize(10);
    if(playingRegularLevel){
        if(game.stats[mouseOverButton]){
            textSize(14);
            textAlign(CENTER, CENTER);
            text("Best Moves", 152, 357.5);
            text("Best Time", 248, 357.5);
            
            textSize(18);
            textAlign(CENTER, CENTER);
            text(game.stats[mouseOverButton].moves, 152, 377);
            text(game.stats[mouseOverButton].time, 248, 377);
        }
    }else{
        textSize(mouseOverButton === "+" ? 18 : 14);
        textAlign(CENTER, CENTER);
        text(mouseOverButton === "+" ? "Make a new level!" :
             numCustomLevels ? "Stats for custom\nlevels are not saved." :
             currentScene === "createLevel" ? "Select a level to edit or\nclick [+] to generate one." :
             "Make your own levels in\nCreate a Level!", 200, 367.5);
    }
    
    if(levelPage > 0){
        btn(17, 17, 30, 30,
            "←", 0);
        arrow(38, 32, 12, -90, 3, 4);
    }
    if(levelPage < totalLevelPages()){
        btn(353, 17, 30, 30,
            "→", 0);
        strokeWeight(3);
        arrow(362, 32, 12, 90, 3, 4);
    }
    
    btn(14, 355, 84, 30,
        playingRegularLevel ? "CUSTOM" : "OFFICIAL", 15);
    
    btn(302, 355, 84, 30,
        "BACK", 15);
    
    if(mouseOverRect(100/3 - 18, 1100/3 - 18, 36, 36)){
        mouseOverButton = "switchLSM";
    }
    
    if(mouseOverRect(1100/3 - 18, 1100/3 - 18, 36, 36)){
        mouseOverButton = "back";
    }
    
    rectMode(CORNER);
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                        Create Level                        *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var selected = {
    element: "smiley",
    color: "R",
    square:{x: 0, y: 0}
};

var handleCustomGridEvents = function(){
    switch(selected.element){
        case "smiley":
            level.me.pos = vec(selected.square.x, selected.square.y);
            level.me.color = selected.color;
            break;
        case "finish":
            level.finish.pos = vec(selected.square.x, selected.square.y);
            level.finish.color = selected.color;
            break;
        case "W":
            level.finish.pos = vec(selected.square.x, selected.square.y);
            level.finish.color = "W";
            break;
        case "space":
            replaceSquare(selected.square.x, selected.square.y, "0");
            break;
        case "wall":
            replaceSquare(selected.square.x, selected.square.y, ".");
            break;
        case "transformer":
            replaceSquare(selected.square.x, selected.square.y, transformer(selected.color));
            break;
        case "brick":
            replaceSquare(selected.square.x, selected.square.y, brick(selected.color));
            break;
        case "gate":
            replaceSquare(selected.square.x, selected.square.y, gate(selected.color));
            break;
    }
};

var customLevelSelected = false;

var createLevel = function(){
    playingRegularLevel = false;
    
    //Grid
    var gridScale = 4/5;
    var scaledTileSize = level.tileSize * gridScale;
    
    scale(gridScale, gridScale);
    
    drawGrid(level.data);
    
    if(currentScene === "createLevel"){
        for(var x = 0; x < level.size; x++){
            for(var y = 0; y < level.size; y++){
                if(mouseOverRect(x * scaledTileSize, y * scaledTileSize, scaledTileSize, scaledTileSize)){
                    translateToGridCoords(vec(x, y));
                    
                    noFill();
                    stroke((selected.element === "space" || selected.element === "wall") ?
                        color(255, 255, 255) : colorByLetter(selected.color));
                    strokeWeight(2);
                    rectMode(CENTER);
                    rect(0, 0, level.tileSize, level.tileSize, 3);
                    rectMode(CORNER);
                    
                    selected.square.x = x;
                    selected.square.y = y;
                    
                    reverseTranslateToGridCoords(vec(x, y));
                    break;
                }
            }
        }
    }
    
    //Draw Finish
    translateToGridCoords(level.finish.pos);
    scale(level.tileSize / 400, level.tileSize / 400);
        
        fill(colorByLetter(level.finish.color));
        stroke(colorByLetter(level.finish.color));
        
        finish(level.finish.color);
        
    scale(400 / level.tileSize, 400 / level.tileSize);
    reverseTranslateToGridCoords(level.finish.pos);
    
    //Draw Smiley
    translateToGridCoords(level.me.pos);
    translate(0.5, 0.5);
    scale(level.tileSize / 400, level.tileSize / 400);
        
        smiley(level.me.color);
        
    scale(400 / level.tileSize, 400 / level.tileSize);
    translate(-0.5, -0.5);
    reverseTranslateToGridCoords(level.me.pos);
    
    scale(1 / gridScale, 1 / gridScale);
    
    //UI
    fill(166, 166, 166, 100);
    noStroke();
    rect(320, 0, 80, 400);
    rect(0, 320, 400, 80);
    
    fill(0, 0, 0, 100);
    rect(320, 84, 80, 20);
    
    textAlign(CENTER, CENTER);
    textSize(selected.element === "transformer" ? 8 : 11);
    if(selected.element === "space" || selected.element === "wall"){
        fill(200, 200, 200);
        text(selected.element, 360, 94);
    }else if(selected.element === "W"){
        colorMode(HSB);
        fill((frameCount * 2) % 255, 255, 240);
        text("multicolor flag", 360, 94);
        colorMode(RGB);
    }else{
        fill(colorByLetter(selected.color));
        text(colorNames(selected.color) + " " + selected.element, 360, 94);
    }
    
    fill(0);
    textAlign(CENTER, CENTER);
    textSize(10);
    text("Mouse Over\n" + selected.square.x + ", " + selected.square.y, 360, 300);
    
    fill(255);
    textAlign(RIGHT, CENTER);
    textSize(12);
    text("Author:", 55, 335);
    text("Lvl Title:", 55, 355);
    
    tBox(60, 327.5, 100, 15, "author", level.author, 12);
    tBox(60, 347.5, 100, 15, "title", level.title, 12);
    
    btn(10, 370, 70, 20,
        "Test Level", 10);
    
    fill(255);
    textAlign(LEFT, CENTER);
    text("Custom Level " + currentLevel, 90, 380);
    
    //Expand/Shrink Level
    textSize(10);
    textAlign(CENTER, CENTER);
    text("Expand", 206.25, 330);
    btn(180, 337.5, 22.5, 22.5,
        "⬉", 0);
    arrow(196, 354, 11, -45, 3, 3);
    btn(210, 337.5, 22.5, 22.5,
        "⬈", 0);
    arrow(217, 354, 11, 45, 3, 3);
    btn(180, 367.5, 22.5, 22.5,
        "⬋", 0);
    arrow(196, 376, 11, -135, 3, 3);
    btn(210, 367.5, 22.5, 22.5,
        "⬊", 0);
    arrow(217, 376, 11, 135, 3, 3);
    
    fill(255);
    textSize(10);
    textAlign(CENTER, CENTER);
    text("Shrink", 276.25, 330);
    btn(250, 337.5, 22.5, 22.5,
        "⬂", 0);
    arrow(258, 346, 11, 135, 3, 3);
    btn(280, 337.5, 22.5, 22.5,
        "⬃", 0);
    arrow(296, 346, 11, -135, 3, 3);
    btn(250, 367.5, 22.5, 22.5,
        "⬀", 0);
    arrow(258, 384, 11, 45, 3, 3);
    btn(280, 367.5, 22.5, 22.5,
        "⬁", 0);
    arrow(296, 384, 11, -45, 3, 3);
    
    //Color Selector
    btn(324, 5, 32, 32,
        "R", 0,
        colorByLetter("R"),
        selected.color === "R" ? color(255, 255, 255) : color(0, 0, 0, 100),
        undefined, undefined, 2,
        colorByLetter("R"));
    btn(363, 5, 32, 32,
        "Y", 0,
        colorByLetter("Y"),
        selected.color === "Y" ? color(255, 255, 255) : color(0, 0, 0, 100),
        undefined, undefined, 2,
        colorByLetter("Y"));
    btn(324, 44, 32, 32,
        "G", 0,
        colorByLetter("G"),
        selected.color === "G" ? color(255, 255, 255) : color(0, 0, 0, 100),
        undefined, undefined, 2,
        colorByLetter("G"));
    btn(363, 44, 32, 32,
        "B", 0,
        colorByLetter("B"),
        selected.color === "B" ? color(255, 255, 255) : color(0, 0, 0, 100),
        undefined, undefined, 2,
        colorByLetter("B"));
    
    
    btn(324, 110, 32, 32,
        "smiley", 0,
        color(255, 255, 255, 100),
        selected.element === "smiley" ? color(255, 255, 255) : color(0, 0, 0, 100),
        undefined, undefined, 2);
    btn(363, 110, 32, 32,
        "finish", 0,
        color(255, 255, 255, 100),
        (selected.element === "finish" || selected.element === "W") ? color(255, 255, 255) : color(0, 0, 0, 100),
        undefined, undefined, 2);
    btn(324, 149, 32, 32,
        "space", 0,
        color(255, 255, 255, 100),
        selected.element === "space" ? color(255, 255, 255) : color(0, 0, 0, 100),
        undefined, undefined, 2);
    btn(363, 149, 32, 32,
        "wall", 0,
        color(255, 255, 255, 100),
        selected.element === "wall" ? color(255, 255, 255) : color(0, 0, 0, 100),
        undefined, undefined, 2);
    btn(324, 188, 32, 32,
        "transformer", 0,
        color(255, 255, 255, 100),
        selected.element === "transformer" ? color(255, 255, 255) : color(0, 0, 0, 100),
        undefined, undefined, 2);
    btn(363, 188, 32, 32,
        "brick", 0,
        color(255, 255, 255, 100),
        selected.element === "brick" ? color(255, 255, 255) : color(0, 0, 0, 100),
        undefined, undefined, 2);
    btn(324, 227, 32, 32,
        "gate", 0,
        color(255, 255, 255, 100),
        selected.element === "gate" ? color(255, 255, 255) : color(0, 0, 0, 100),
        undefined, undefined, 2);
    
    //Element Selector
    //Smiley
    translate(340, 126);
    scale(3/50, 3/50);
        smiley(selected.color);
    scale(50/3, 50/3);
    translate(-340, -126);
    
    //Flag
    translate(379, 126);
    scale(3/50, 3/50);
        finish(selected.element === "W" ? "W" : selected.color);
    scale(50/3, 50/3);
    translate(-379, -126);
    
    //Space
    stroke(0);
    strokeWeight(2);
    line(332.5, 157.5, 347.5, 172.5);
    line(347.5, 157.5, 332.5, 172.5);
    
    //Wall
    var b = game.barrierBrightness * 10 + 4;
    fill(b, b, b, 200);
    noStroke();
    rect(370, 156, 19, 19);
    
    //Transformer
    fill(floor(random(0, 8.999)) % 8 > 0 ? colorByLetter(selected.color) :
        color(80, 80, 80, 200));
    noStroke();
    rect(331, 195, 19, 19);
    
    //Breakable Brick
    translate(379, 204);
    scale(19/400, 19/400);
        drawBreakableBrick(selected.color);
    scale(400/19, 400/19);
    translate(-379, -204);
    
    //Gate
    translate(340, 243);
    scale(19/400, 19/400);
        drawGate(selected.color);
    scale(400/19, 400/19);
    translate(-340, -243);
    
    //Save Button
    btn(330, 330, 60, 25,
        "SAVE", 15);
    //Menu Button
    btn(330, 365, 60, 25,
        "MENU", 15);
    
    if(!customLevelSelected){
        fill(100, 100, 100);
        noStroke();
        rect(0, 0, 320, 320);
        
        clearButtonsAndTextBoxes();
        playingRegularLevel = false;
        
        fill(100, 100, 100, 200);
        noStroke();
        rect(0, 0, 400, 400);
        
        levelSelect();
    }
};

var MIN_LEVEL_SIZE = 3;
var MAX_LEVEL_SIZE = 20;

var expandOrShrinkLevel = function(direction){
    var newRow = "";
    
    var setNewRow = function(){
        newRow = "";
        for(var i = 0; i < level.size; i++){
            newRow += "0";
        }
    };
    
    setNewRow();
    
    var resetSize = function(){
        level.size = max(level.data.length, level.data[0].length);
        level.tileSize = 400 / level.size;
        setNewRow();
    };
    
    var rowUp = function(addNew){
        if(addNew){
            level.data.unshift(newRow);
        }else{
            level.data.shift(newRow);
        }
        level.me.pos.y += addNew ? 1 : -1;
        level.finish.pos.y += addNew ? 1 : -1;
        
        resetSize();
    };
    var rowDown = function(addNew){
        if(addNew){
            level.data.push(newRow);
        }else{
            level.data.pop(newRow);
        }
        resetSize();
    };
    var columnLeft = function(addNew){
        for(var i = 0; i < level.size; i++){
            if(addNew){
                level.data[i] = "0" + level.data[i];
            }else{
                level.data[i] = level.data[i].substr(1);
            }
        }
        level.me.pos.x += addNew ? 1 : -1;
        level.finish.pos.x += addNew ? 1 : -1;
        
        resetSize();
    };
    var columnRight = function(addNew){
        for(var i = 0; i < level.size; i++){
            if(addNew){
                level.data[i] += "0";
            }else{
                level.data[i] = level.data[i].substr(0, level.size - 1);
            }
        }
        resetSize();
    };
    
    if(level.size < MAX_LEVEL_SIZE){
        switch(direction){
            case "⬉": rowUp(true); columnLeft(true); break;
            case "⬈": rowUp(true); columnRight(true); break;
            case "⬋": rowDown(true); columnLeft(true); break;
            case "⬊": rowDown(true); columnRight(true); break;
        }
    }
    
    if(level.size > MIN_LEVEL_SIZE){
        switch(direction){
            case "⬂": columnLeft(false); rowUp(false); break;
            case "⬃": columnRight(false); rowUp(false); break;
            case "⬀": columnLeft(false); rowDown(false); break;
            case "⬁": columnRight(false); rowDown(false); break;
        }
    }
    
    level.me.pos.x = constrain(level.me.pos.x, 0, level.size - 1);
    level.me.pos.y = constrain(level.me.pos.y, 0, level.size - 1);
    level.finish.pos.x = constrain(level.finish.pos.x, 0, level.size - 1);
    level.finish.pos.y = constrain(level.finish.pos.y, 0, level.size - 1);
};

var createLevelMenu = function(){
    customLevelSelected = true;
    
    //filter(BLUR, 1);
    clearButtonsAndTextBoxes();
    fill(savedBackgroundColor);
    noStroke();
    rect(0, 0, 400, 400);
    
    fill(255);
    textSize(50);
    textAlign(CENTER, CENTER);
    text("Create a Level", 200, 100);
    
    fill(0, 255, 0);
    strokeWeight(3);
    btn(90, 170, 220, 60,
        "Main Menu", 38, color(0, 255, 0), 1, color(0, 0, 0));
        
    btn(20, 250, 170, 42,
        "Custom Level Select", 16, color(146, 0, 194), 1);
    
    colorMode(HSB);
    btn(210, 250, 170, 42,
        "Submit Your Level", 18,
        color((frameCount * 2) % 255, 200, 255),
        color(0, 0, random(200, 255)),
        color(0, 0, 255), undefined, undefined,
        color(0, 0, 255),
        color((frameCount * 2) % 255, 255, 255),
        color((frameCount * 2) % 255, 255, 255));
    colorMode(RGB);
    
    btn(20, 310, 170, 42,
        "Tips For Making Great\nTranscolors Levels", 12, color(0, 194, 155), 1);
    
    btn(210, 310, 170, 40,
        "Settings", 24, color(143, 143, 143), 1);
    
    btn(330, 365, 60, 25,
        "BACK", 14,
        color(0), 1, color(255));
};

var tipsForCreatingGreatTranscolorsLevels = 0;


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                          Settings                          *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var settingsPage = function(){
    if(previousScene() === "title"){
        drawAndUpdateTransformCircles(true);
    }else if(previousScene() === "paused"){
        playLevel();
        fill(84);
        noStroke();
        rect(0, 380, 400, 20);
        fill(savedBackgroundColor);
        noStroke();
        rect(0, 0, 400, 400);
    }else if(previousScene() === "createLevelMenu"){
        createLevel();
        fill(84);
        noStroke();
        rect(0, 380, 400, 20);
        fill(savedBackgroundColor);
        noStroke();
        rect(0, 0, 400, 400);
    }
    
    btn(smileyTopLeft ? 340 : 5, 5, 55, 25,
        "BACK", 14);
    
    fill(255);
    textAlign(CENTER, CENTER);
    textSize(10);
    text("NOTE: If DELETE or BACKSPACE makes your browser\ngo back a page, please use the LEFT arrow instead!", 200, 20);

    fill(255);
    textSize(15);
    textAlign(LEFT, CENTER);
    text("Username:", 25, 60);
    tBox(25, 75, 350, 20, "username", game.username);
    
    fill(255);
    textSize(15);
    textAlign(LEFT, CENTER);
    text("Text font:", 25, 120);
    tBox(25, 135, 350, 20, "font", game.font);
    
    fill(255);
    textSize(15);
    textAlign(LEFT, CENTER);
    text("Better Performance (less fancy graphics):", 25, 180);
    sbtn(300, 170, 75, 20,
        "Better Performance", game.betterPerformance, 10);
    
    fill(255);
    textSize(15);
    textAlign(LEFT, CENTER);
    text("Use Local Storage?", 25, 210);
    textSize(10);
    textAlign(RIGHT, CENTER);
    /*
    text(game.useLocalStorage ?
        "Your game will save to local storage in your browser if possible."
        : "Your game will output code to the console log; paste into a spin-off.",
        375, 230);*/
    text("Sorry! Local storage is not allowed by Khan Academy.", 375, 230);
    /*
    sbtn(300, 200, 75, 20,
        "Use Local Storage", game.useLocalStorage, 10);
        */
    noFill();
    stroke(200);
    rect(300, 200, 75, 20, 5);
    
    /*
    if(mouseIsPressed && abs(scaledMouseY - 260) < 24){
        game.barrierBrightness = max(min(round((scaledMouseX - 25) / 35), 10), 0);
    }
    */
    
    btn(320, 355, 70, 20,
        "Reset Game", 10, 0, 0);
    
    fill(255);
    footer();
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                       Announcements                        *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var announcements = function(){
    drawAndUpdateTransformCircles(true);
    
    btn(15, 15, 370, 75,
        "FAQs", 0,
        color(0, 0, 0, 1), color(0, 0, 0, 1), undefined, 5, undefined,
        color(255, 255, 255, 150), undefined, color(0, 0, 0, 1));
    drawTitle();
    
    fill(255, 255, 255, 200);
    noStroke();
    rect(15, 105, 370, 280, 5);
    
    fill(0);
    textAlign(CENTER, TOP);
    textSize(12);
    text("Announcements\n\nI have decided to develop Transcolors as an app on the App Store. Exciting times! I can't make any guarantees, but I'm hoping to get it out sometime this year, for possibly $1.99. I'll let all of you know when it's out, but in the meantime, enjoy this completely redesigned program!\n\nAlso, I'm going to need your help to create some levels for me! Only the best ones will go into the app! Do you have what it takes? Head over to Create a Level right now and get started!\n\nTo clarify, TRANSCOLORS IS NOT ON THE APP STORE YET. I will make it known to everyone I know when it is released.\n\nRead about Transcolors and the app at darryl-yeo.com/transcolors!\n\n– DY", 25, 115, 350, 290);
};

var outputCustomLevel = function(){
    println("");
    var textToPrint = 'Paste this code under "Custom Levels Here".\n\nSubmitting this level? READ THE INSTRUCTIONS UNDER "Submit Your Level." DO NOT PASTE LEVEL CODE DIRECTLY INTO YOUR SUBMISSION POST!!! I will NOT look at it!\n\n';
    textToPrint += "//Level ";
    textToPrint += currentLevel.toString();
    textToPrint += "\nnewCustomLevel([\n";
    for(var i = 0; i < level.size; i++){
        textToPrint += '    "';
        textToPrint += level.data[i];
        textToPrint += '"';
        textToPrint += i === level.size - 1 ? "\n    ],\n    " : ",\n";
    }
    textToPrint += level.me.pos.x + ', ';
    textToPrint += level.me.pos.y + ', "';
    textToPrint += level.me.color + '",\n    ';
    textToPrint += level.finish.pos.x + ', ';
    textToPrint += level.finish.pos.y + ', "';
    textToPrint += level.finish.color + '",\n    0, "';
    textToPrint += level.author + '"';
    if(level.title){textToPrint += ', "' + level.title + '"';}
    textToPrint += ");";
    println(textToPrint);
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                            FAQs                            *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var FAQs = function(){
    drawAndUpdateTransformCircles(true);
    
    btn(15, 15, 370, 75,
        "FAQs", 0,
        color(0, 0, 0, 1), color(0, 0, 0, 1), undefined, 5, undefined,
        color(255, 255, 255, 150), undefined, color(0, 0, 0, 1));
    drawTitle();
    
    fill(255, 255, 255, 200);
    noStroke();
    rect(15, 105, 370, 280, 5);
    
    fill(0);
    textAlign(CENTER, TOP);
    textSize(12);
    text("FAQs\n\nQ: But I thought you were on Version 7!\nA: Okay, so I cheated a little. This is the biggest update I've had, and it deserves a lot more than the \"updates\" I've had in the past. Consider Version 7.2 Version 1.7.2 instead.\n\nQ: How do I make a multicolored flag in Create a Level?\nA: Click the flag button, then click it again.\n\nQ: Can Smiley go faster when I hold down the arrow keys?\nA: I actually don't control that. This is the key repeat rate on your computer, which likely can be set in your system preferences.\n\nQ: How's the app?\nA: Getting there! I'll post screenshots later on.", 25, 115, 350, 290);
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                            FAQs                            *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var links = function(){
    drawAndUpdateTransformCircles(true);
    
    fill(255);
    textSize(50);
    textAlign(CENTER, CENTER);
    text("Links", 200, 50);
    
    btn(80, 100, 240, 45, "Transcolors 1.0", 27);
    btn(80, 150, 240, 45, "Avatar Edition", 27);
    btn(80, 200, 240, 45, "Promo Poster", 27);
    btn(80, 250, 240, 45, "1st Anniversary", 27);
    btn(80, 300, 240, 45, "App Screenshot", 27);
    
    btn(10, 10, 60, 25,
        "BACK", 14,
        color(0), 1, color(255));
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                            Move                            *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var smileyMoved = function(){
    if(currentScene !== "win"){currentStats.moves++;}
    
    //What is Smiley on top of?
    switch(characterOnTile()){
        case "r":newTransformAnimation(colorByLetter(level.me.color), colorByLetter("R"));level.me.color = "R"; break;
        case "y":newTransformAnimation(colorByLetter(level.me.color), colorByLetter("Y"));level.me.color = "Y"; break;
        case "g":newTransformAnimation(colorByLetter(level.me.color), colorByLetter("G"));level.me.color = "G"; break;
        case "b":newTransformAnimation(colorByLetter(level.me.color), colorByLetter("B"));level.me.color = "B"; break;
        case "®": case "¥": case "©": case "∫":
            resetWallAnimation();
            replaceSquare(level.me.pos.x, level.me.pos.y, "0");
            break;
    }
};

var brickObstacleControl = function(x, y){
    var wOC = true;
    for(var i = 0; i < colors.length; i++){
        if(colors[i] !== level.me.color && getTileAt(x, y) === brick(colors[i])){
            wOC = false;
        }
    }
    return wOC;
};

var gateObstacleControl = function(x, y){
    var wOC = true;
    for(var i = 0; i < colors.length; i++){
        if(colors[i] !== level.me.color && getTileAt(x, y) === gate(colors[i])){
            wOC = false;
        }
    }
    return wOC;
};

var left = function(){
    level.me.direction = "W";
    if(level.me.pos.x !== 0 &&
       tileLeftOfCharacter() !== "." &&
       brickObstacleControl(level.me.pos.x - 1, level.me.pos.y) &&
       gateObstacleControl(level.me.pos.x - 1, level.me.pos.y) &&
       currentScene !== "paused" &&
       currentScene !== "createLevel" &&
       levelRunning){
        level.me.pos.x--;
        smileyMoved();
    }
};

var right = function(){
    level.me.direction = "E";
    if(level.me.pos.x !== level.size - 1 &&
       tileRightOfCharacter() !== "." &&
       brickObstacleControl(level.me.pos.x + 1, level.me.pos.y) &&
       gateObstacleControl(level.me.pos.x + 1, level.me.pos.y) &&
       currentScene !== "paused" &&
       currentScene !== "createLevel" &&
       levelRunning){
        level.me.pos.x++;
        smileyMoved();
    }
};

var up = function(){
    level.me.direction = "N";
    if(level.me.pos.y !== 0 &&
       tileAboveCharacter() !== "." &&
       brickObstacleControl(level.me.pos.x, level.me.pos.y - 1) &&
       gateObstacleControl(level.me.pos.x, level.me.pos.y - 1) &&
       currentScene !== "paused" &&
       currentScene !== "createLevel" &&
       levelRunning){
        level.me.pos.y--;
        smileyMoved();
    }
};

var down = function(){
    level.me.direction = "S";
    if(level.me.pos.y !== level.size - 1 &&
       tileBelowCharacter() !== "." &&
       brickObstacleControl(level.me.pos.x, level.me.pos.y + 1) &&
       gateObstacleControl(level.me.pos.x, level.me.pos.y + 1) &&
       currentScene !== "paused" &&
       currentScene !== "createLevel" &&
       levelRunning){
        level.me.pos.y++;
        smileyMoved();
    }
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                         Save Game                          *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

/*username: "",
    stats: [
        {moves: 0, time: 0}
    ],
    font: "Avenir",
    barrierBrightness: 5,
    flashingColors: true*/

var saveGame = function(){/*
    if(game.useLocalStorage){
        //Unpack components of "game" and save each one as separate pieces of data
        setItem("TranscolorsUsername", game.username);
        setItem("TranscolorsFont", game.font);
        setItem("TranscolorsPerformance", game.betterPerformance);
        
        var movesData = "";
        var timeData = "";
        for(var i = 1; i < game.stats.length; i++){
            movesData += game.stats[i].moves ? game.stats[i].moves.toString() : "N/A";
            movesData += "/";
            timeData += game.stats[i].time ? game.stats[i].time.toString() : "N/A";
            timeData += "/";
        }
        setItem("TranscolorsMoves", movesData);
        setItem("TranscolorsTime", timeData);
    
        displayMessage("Game saved successfully. Thanks for playing!", 100, 60);
    }else{*/
        var textToPrint = 'Copy the following, replace "game" variable at beginning of code and save a spin-off!\n\n';
        textToPrint += 'var game = {\n    username: "';
        textToPrint += game.username;
        textToPrint += '",\n    stats: [\n';
        for(var i = 0; i < game.stats.length; i++){
            if(game.stats[i]){
                textToPrint += '        {moves: ';
                textToPrint = textToPrint.concat(game.stats[i].moves);
                textToPrint += ", time: ";
                textToPrint = textToPrint.concat(game.stats[i].time);
                textToPrint += "}";
            }else{
                textToPrint += '        undefined';
            }
            if(i !== game.stats.length - 1){
                textToPrint += ",\n";
            }
        }
        textToPrint += '\n    ],\n    font: "';
        textToPrint += game.font;
        textToPrint += '",\n    betterPerformance: ';
        textToPrint += game.betterPerformance;
        //textToPrint += ',\n    useLocalStorage: ';
        //textToPrint += game.useLocalStorage;
        textToPrint += '\n};\n';
        
        println(textToPrint);
    //}
};

var resetGame = function(){
    /*
    setItem("TranscolorsUsername", "");
    setItem("TranscolorsFont", "Avenir");
    setItem("TranscolorsMoves", undefined);
    setItem("TranscolorsTime", undefined);
    setItem("TranscolorsPerformance", undefined);
    displayMessage("Resetting local storage data...", 100);
    */
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                       Mobile Edition                       *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var mobile = false;

var mobileEdition = function(){
    //Mobile Version
    fill(100, 100, 100, 150);
    noStroke();
    rect(400, 0, 600, 400);
    
    if(!mobile){
        fill(255);
        textSize(25);
        textAlign(CENTER, CENTER);
        text("The canvas size changes on iPads! If you can see this, tap here to launch mobile edition!", 420, 20, 360, 280);
        
        textSize(14);
        text("Otherwise, this goes away when you press START.", 600, 300);
        
        ibtn(400, 0, 400, 400,
            "mobile");
        btn(560, 340, 80, 20,
            "No thanks", 12);
    }else{
        if(currentScene === "level" || currentScene === "paused" || currentScene === "win" || previousScene === "paused"){
            if(scaledMouseX > 400 && mouseIsPressed){
                fill(255, 255, 255, 200);
                if(scaledMouseY > -scaledMouseX + 800){
                    if(scaledMouseY > scaledMouseX - 400){
                        triangle(600, 200, 400, 400, 800, 400);
                    }else if(scaledMouseY < scaledMouseX - 400){
                        triangle(600, 200, 800, 0, 800, 400);
                    }
                }else if(scaledMouseY < -scaledMouseX + 800){
                    if(scaledMouseY > scaledMouseX - 400){
                        triangle(600, 200, 400, 0, 400, 400);
                    }else if(scaledMouseY < scaledMouseX - 400){
                        triangle(600, 200, 400, 0, 800, 0);
                    }
                }
            }
            fill(255);
            noStroke();
            triangle(600, 30, 550, 80, 650, 80);
            triangle(770, 200, 720, 150, 720, 250);
            triangle(600, 370, 550, 320, 650, 320);
            triangle(430, 200, 480, 150, 480, 250);
        }else{
            fill(255);
            textSize(50);
            textAlign(CENTER, CENTER);
            text("Mobile Edition", 600, 52.5);
            
            textSize(16);
            text("Keep in mind that you may not be able to save your progress using a mobile device.\n\nTip: To go really fast, alternate taps with two fingers on one arrow key!", 420, 130, 360, 250);
            
            translate(600, 140);
            scale(1/5, 1/5);
            smiley("R", "☺");
            scale(5, 5);
            translate(-600, -140);
        }
    }
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                          Keyboard                          *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

var updateStringAfterType = function(string){
    string = string ? string : "";
    
    if(keyCode === BACKSPACE || keyCode === DELETE || keyCode === LEFT){
        return string.slice(0, string.length - 1);
    }else if(keyCode !== SHIFT && keyCode !== ALT){
        return string + key.toString();
    }else{
        return string;
    }
};

keyPressed = function(){
    if(selectedTextBox){
        switch(selectedTextBox){
            case "username":
                game.username = updateStringAfterType(game.username);
                break;
            case "font":
                game.font = updateStringAfterType(game.font);
                break;
            case "author":
                level.author = updateStringAfterType(level.author);
                break;
            case "title":
                level.title = updateStringAfterType(level.title);
                break;
        }
        /*
        if(currentScene === "settings"){
            if(keyCode >= 65 && keyCode <= 90){
                gameFont += alph[keyCode - 65 + offset];
            }else if(keyCode >= 48 && keyCode <= 57)
            {
                gameFont += nums[keyCode - 48 + num_offset];
            }else{
                switch(keyCode){
                    case 32: gameFont += " "; break;
                    case 188: gameFont += ","; break;
                    case 16: offset = 26; num_offset = 10; break;
                    case 8: gameFont = gameFont.slice(0, gameFont.length-1); break;
                }
            }
        }
        */
    }else{
        switch(keyCode){
            case LEFT: left(); startCountdown(); break;
            case RIGHT: right(); startCountdown(); break;
            case UP: up(); startCountdown(); break;
            case DOWN: down(); startCountdown(); break;
            case RETURN: case ENTER:
                if(currentScene === "level"){
                    switchScene("paused");
                    randomizeBackgroundColor();
                }else if(currentScene === "win"){
                    if(playingRegularLevel){
                        if(currentLevel <= numLevels){
                            switchScene("level", true, function(){
                                currentLevel++;
                                resetLevel();
                            });
                        }
                    }else{
                        switchScene("createLevel", true);
                    }
                }
                break;
            default:
                switch(key.toString()){
                    case " ":
                        if(currentScene === "win" || (currentScene === "level" && levelRunning && !countingDown)){
                            switchScene("level", true, resetLevel, true);
                        }
                        startCountdown();
                        break;
                    case "d":
                        debugMode = !debugMode;
                        if(debugMode){
                            displayMessage("You're in debug mode. Press d to return.", 100);
                        }
                        break;
                    case "m":
                        revertSize();
                        displayMessage("Mobile edition disabled. Your program thumbnail won't get squished.", 100, undefined, "⊗");
                        break;
                }
        }
    }
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                           Mouse                            *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

//mouseClicked = function(){
mouseReleased = function(){
    if(mouseOverTextBox){
        selectedTextBox = mouseOverButton;
    }
    
    if(mouseOverMessageButton){
        //if(mouseOverButton === "Settings"){
            //selectedTextBox = "username";
        //}
        
        message.enabled = false;
    }
    
    if((currentScene === "title" || currentScene === "levelSelect" ||
        currentScene === "settings" || currentScene === "announcements" ||
        currentScene === "FAQs" || currentScene === "LINKS") &&
        previousScene() !== "paused"){
        transformCircle();
    }
    
    switch(mouseOverButton){
        case "START":
            resetLevel();
            switchScene("level", true);
            if(!mobile){
                revertSize();
            }
            break;
        case "Level Select":
            previousSceneIsPauseMenu = currentScene === "paused";
            //playingRegularLevel = true;
            switchScene("levelSelect", currentScene === title);
            break;
        case "Save Game":
            if(game.useLocalStorage){
                displayMessage("This will save your stats and settings to your local storage and overwrite any existing data. Click to confirm.", 0, 60, "Confirm Save Game");
            }else{
                saveGame();
            }
            break;
        case "Confirm Save Game":
            saveGame();
            break;
        case "Create a Level":
            randomizeBackgroundColor();
            customLevelSelected = false;
            switchScene("createLevel", true);
            break;
        case "R": case "Y": case "G": case "B":
            selected.color = mouseOverButton;
            break;
        case "smiley": case "space": case "wall": case "transformer": case "brick": case "gate":
            selected.element = mouseOverButton;
            break;
        case "finish":
            selected.element = selected.element === "finish" ? "W" : "finish";
            break;
        case "⬉": case "⬈": case "⬋": case "⬊": case "⬂": case "⬃": case "⬀": case "⬁":
            expandOrShrinkLevel(mouseOverButton);
            break;
        case "Test Level":
            displayMessage("Be sure to save your level before each test, as there's always a chance you might lose your work! Click to test!", undefined, undefined, "Confirm Test Level");
            break;
        case "Confirm Test Level":
            switchScene("level", true);
            break;
        case "Edit Level":
            switchScene("createLevel", true);
            customLevelSelected = true;
            break;
        case "SAVE":
            displayMessage("Submitting this level?\nClick here for instructions.\n\n\n\n\n\n", 600, 400, "Submit Your Level", 32);
            outputCustomLevel();
            break;
        case "MENU":
            switchScene("createLevelMenu");
            break;
        case "Custom Level Select":
            switchScene("levelSelect");
            customLevelSelected = false;
            break;
        case "+":
            if(numCustomLevels === 0){
                displayMessage("First time making a level?\nClick here for a few tips!", undefined, 80, "Tips For Making Great\nTranscolors Levels", 20);
            }
            else{
                displayMessage("Generated a new level. Have fun!", 100);
            }
            newPresetCustomLevel();
            resetLevel();
            currentLevel = numCustomLevels + 1;
            customLevelSelected = true;
            break;
        case "Submit Your Level":
            displayMessage("Looks like you've got a puzzling level for me to include in the game!\n\nBefore you do ANYTHING, please read over the \"Tips For Making Great Transcolors Levels\" and make sure your level fits the requirements. Your level will be more likely to be accepted if it fits those requirements.\n\nDone? Awesome. Click anywhere on this message to get started.", undefined, 400, "Submit Your Level 2", 23, 230);
            break;
        case "Submit Your Level 2":
            switchScene("createLevel");
            displayMessage("Read carefully BEFORE doing ANYTHING!\n\nGet your level code by pressing SAVE. Paste it inside of the program under \"Custom Levels Here.\" Save as a spin-off. (If you already have a spin-off, paste your level there.)\n\nCopy the LINK to your spin-off. Head over to the QUESTIONS section of Transcolors and find the post that reads \"TRANSCOLORS LEVEL SUBMISSIONS.\"\n\nPost the link to your spin-off as a new ANSWER.\nDO NOT POST A COMMENT OR A TIPS/THANKS!\n\nI will play your level. If it can be made better, I will give you some constructive feedback via a comment. Once you have made your improvements, COMMENT BACK on your existing answer so I know I should look at it again. If it's ready to go, I will include your level in the next update!\n\n(If you have previously submitted a level, tell me which level is new as a comment in your existing answer. I will follow the same link you posted for your first level.)\n\nClick anywhere to get your level code. I can't wait to see what you come up with!", undefined, 400, "SAVE", 13, 230);
            break;
        case "Tips For Making Great\nTranscolors Levels":
            tipsForCreatingGreatTranscolorsLevels = 0;
            displayMessage("Okay, puzzle authors! You're about to learn all the secrets behind making the best Transcolors puzzles in the universe.\n\nKeep to these guidelines, and your level is almost guaranteed a spot in this game on the first try. Fail to shape up, and you might have to fix your level up before I'll take it.\n\nPuzzle-making is an art form that takes time to master. It gets better with practice. Trust me. I know.\n\nLet’s get started – click anywhere!", undefined, 400, "TFMGTL", 19, 235);
            break;
        case "TFMGTL":
            tipsForCreatingGreatTranscolorsLevels++;
            switch(tipsForCreatingGreatTranscolorsLevels){
                case 1:
                    displayMessage("1. KEEP THE PUZZLE TO A MINIMUM.\n\nMake the most of every element you place on the board. Use the SMALLEST board size necessary for the length of your puzzle. Use no wide open space without a reason!\n\nA good example is Level 54, \"To the Power of 2.\" This level is only 4x4 squares, but it serves as a puzzle that takes longer to solve than it looks!", undefined, 400, "TFMGTL", 22, 235);
                    break;
                case 2:
                    displayMessage("2. AVOID REDUNDANCY.\n\nIf two bricks of the same color are next to each other, and both block the same passageway, that's essentially one large brick – reduce it to just one! The same is true of gates. The exceptions are when the cluster of similar blocks are potentially blocking MULTIPLE pathways – that's acceptable.\n\nBut NEVER place transformers next to each other if they're the same color. That's essentially one large transformer!\n\n", undefined, 400, "TFMGTL", 20, 235);
                    break;
                case 3:
                    displayMessage("3. STAY CONSISTENT.\n\nRepeat any recurring features throughout your ENTIRE puzzle. \"Recurring features\n can be many things.\n\nIs your puzzle maze-like and path-driven? Keep all paths and walls exactly 1 block wide, and avoid any 2x2 rectangles of empty space.\n\nDoes your level have a more open and free feel to it, with various obstacles floating around? Space things out evenly!\n\nYou need not have ONE \"recurring feature\" throughout the entire maze. You can have multiple \"areas\" in a puzzle with a different feel to each, so long as it's clear how they are visually set apart.", undefined, 400, "TFMGTL", 17, 235);
                    break;
                case 4:
                    displayMessage("4. BALANCE PUZZLE AND REPETITION.\n\nThere are two elements of a puzzle: decision-making and execution. Making decisions throughout the level is what keeps players engaged and thinking. Actually carrying out the strategy is what keeps the players \"active\" and leads them to the next decision.\n\nIf a player goes too long without making a decision, they get bored. This can happen if you have a whole ton of bricks blocking a passageway, ALTERNATING COLOR. There is no decision-making here; it's just busywork, going back and forth to retrieve a color just to advance one step out of who knows how many.\n\nOn the other hand, if the player has to make a decision at every turn, they could get frustrated easily. But this is the better of the two circumstances, because in a puzzle game, this can be good thing – it's meant to be challenging.\n\nHow do you know how much PUZZLE and REPETITION to include? Play the level yourself, start to end. Don't be lazy. If you get bored or frustrated, you know that the balance between the two is off!", undefined, 400, "TFMGTL", 14, 235);
                    break;
                case 5:
                    displayMessage("Some of the best levels are simple.", undefined, 400, "TFMGTL", 20, 230);
                    break;
                case 6:
                    displayMessage("Make booby traps! This can be achieved with a transformer in a chamber completely enclosed by gates. Once the player enters the chamber and transforms, all of the gates close because none match that color! Tricky!", undefined, 400, "TFMGTL", 20, 230);
                    break;
                case 7:
                    displayMessage("Don’t create a short path AND a long path simultaneously – the player will just take the short path, making your complicated long path – which you worked SO hard on – completely useless!\n\nWhat you CAN do is make it so that it is not obvious which path is shorter. The best is to make it just a FEW blocks shorter so that they might not get the lowest move count on their first try!", undefined, 400, "TFMGTL", 20, 230);
                    break;
                case 8:
                    displayMessage("I am sort of a perfectionist. Everything must be neat! This is something that’s difficult to explain. For starters, try to keep everything in a SQUARE or any orderly looking, geometrical shape. Avoid a \"wall void\", or a large chunk of wall in the middle of the maze. Use the space for something, well useful. If you find yourself with a wall void, consider rotating a section of path 90 degrees to fill the area. This would minimize the size of the level while keeping it just as puzzling.", undefined, 400, "TFMGTL", 20, 230);
                    break;
                case 9:
                    displayMessage("Finally, save and test your level OFTEN! This ensures that it's SOLVABLE and isn’t way too tedious!", undefined, 400, "TFMGTL", 20, 230);
                    break;
            }
            //displayMessage("1. NEVER put two transformers of the same color directly adjacent to each other, unless you have a good reason. Also, don't place too many gates, as it gets laggy. Try to \"double\" up gate paths – two adjacent paths made of gates could be merged into one empty path, but only accessible to those two colors.\n\n2. The best levels are the ones that really make you think. A DIFFICULT level is not always the same as a LONG and TEDIOUS one. What I do NOT want is a long pathway blocked by alternating bricks or any kind of checkerboard pattern. Those levels don't really challenge your skill; they're just ANNOYING.\n\n3. Be creative with your maze. Change the size. You don't always have to start at the top left and end at the bottom right.\n\n4. Have a good use for all parts of your maze. Set booby traps if you like. Don't allow the player to easily win while skipping a whole section of the maze.\n\n5. Make sure the start and finish are on empty spaces.\n\n6. If your level has a \"pathway\" style, please make all pathways 1 block wide. Avoid any 2x2 rectangles of empty space.\n\n7. Test your level often to make sure it is solvable (and be sure to save it before you do so).", undefined, 400, undefined, 11);
            break;
        case "Settings":
            previousSceneIsPauseMenu = currentScene === "paused";
            previousSceneIsCreateLevelMenu = currentScene === "createLevelMenu";
            switchScene("settings");
            break;
        case "Announcements":
            switchScene("announcements");
            break;
        case "FAQs":
            if(currentScene === "announcements"){
                switchScene("FAQs");
            }else if(currentScene === "FAQs"){
                switchScene("title");
            }
            break;
        case "LINKS":
            switchScene("LINKS");
            break;
        case "Transcolors 1.0":
            println("www.khanacademy.org/cs/transcolors-version-172-by-dy/1553568203");
            break;
        case "Avatar Edition":
            println("www.khanacademy.org/cs/transcolors-avatar-edition-version-223-by-dy/5248409377177600");
            break;
        case "Promo Poster":
            println("www.khanacademy.org/cs/transcolors-promo-poster/5801489777819648");
            break;
        case "1st Anniversary":
            println("www.khanacademy.org/cs/happy-birthday-transcolors/6662013812998144");
            break;
        case "App Screenshot":
            println("www.khanacademy.org/cs/transcolors-app-screenshot/6264939590189056");
            break;
        case "DY":
            println("CREATED BY DY");
            //println("SPIN-OFF BY [your name here]");
            println("Check out all of DY's AWESOME programs at");
            println("www.khanacademy.org/profile/darrylyeo/programs");
            break;
        case "Replay Level":
            switchScene("level", true, resetLevel, true);
            break;
        case "Next Level":
            if(currentLevel <= numLevels){
                switchScene("level", true, function(){
                    currentLevel++;
                    resetLevel();
                });
            }
            break;
        case "Pause Level":
            switchScene("paused");
            randomizeBackgroundColor();
            break;
        case "Main Menu": case "Return to Main Menu":
            switchScene("title", true);
            break;
        case "←":
            levelPage--;
            break;
        case "→":
            levelPage++;
            break;
        case "CUSTOM":
            playingRegularLevel = false;
            break;
        case "OFFICIAL":
            playingRegularLevel = true;
            break;
        case "Reset Game":
            displayMessage("Nothing to reset! Local storage is not allowed by Khan Academy. :(", 100);
            //displayMessage("Alert: Your username, settings, and all game progress will be erased. Click to continue.", 0, 60, "Confirm Reset Game");
            break;
        /*
        case "Confirm Reset Game":
            resetGame();
            Program.restart();
            break;
        */
        case "BACK":
            switchScene(PREVIOUS);
            //paused = true;
            break;
        case "⊗":
            message.enabled = false;
            break;
        case "mobile":
            mobile = true;
            break;
        case "No thanks":
            revertSize();
            break;
        default:
            if(typeof mouseOverButton === "number"){
                currentLevel = mouseOverButton;
                if(currentScene === "createLevel"){
                    customLevelSelected = true;
                    resetLevel();
                }else{
                    switchScene("level", true, resetLevel);
                }
                if(!mobile){
                    revertSize();
                }
            }else if(mouseOverSwitchButton){
                switch(mouseOverButton){
                    case "Better Performance":
                        game.betterPerformance = !game.betterPerformance;
                        break;
                    /*
                    case "Use Local Storage":
                        game.useLocalStorage = !game.useLocalStorage;
                        break;
                    */
                }
            }
            startCountdown();
    }
    
    if(scaledMouseX > 400){
        if(scaledMouseY > -scaledMouseX + 800){
            if(scaledMouseY > scaledMouseX - 400){
                down();
            }else if(scaledMouseY < scaledMouseX - 400){
                right();
            }
        }else if(scaledMouseY < -scaledMouseX + 800){
            if(scaledMouseY > scaledMouseX - 400){
                left();
            }else if(scaledMouseY < scaledMouseX - 400){
                up();
            }
        }
    }
    //println(mouseOverButton);
};

mousePressed = function(){
    if(currentScene === "createLevel" && customLevelSelected &&
        mouseOverRect(0, 0, 320, 320)){
        handleCustomGridEvents();
    }
};

mouseDragged = function(){
    scaleMouse();
    
    if(currentScene === "createLevel" &&
       mouseOverRect(0, 0, 320, 320)){
        handleCustomGridEvents();
    }
};

mouseMoved = function(){
    scaleMouse();
    
    //Change cursor if necessary
    //(If possible, move to draw function!)
    if(mouseOverTextBox){
        this.cursor(TEXT);
    }else if(mouseOverButton){
        this.cursor(HAND);
    }else if(currentScene === "createLevel" && customLevelSelected &&
       mouseOverRect(0, 0, 320, 320)){
        this.cursor(CROSS);
    }else{
        this.cursor(ARROW);
    }
};


/** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **\
*                            Draw                            *
\** ** ** ** ** ** ** ** ** * ** * ** ** ** ** ** ** ** ** **/

frameRate(40);

var beginningMessage = function(){
    //Beginning of the game setup
    if(!game.username){
        displayMessage("Welcome to Transcolors! Click here to set a username!", 250, 40, "Settings");
    }else{
        displayMessage("Welcome back, " + game.username + "! Thanks for playing again!", 100, 40);
    }
};

//Ninja Mode
/*
draw = function() {
    keyReleased = function(){
        if(keyCode === ENTER){
            frameCount = 0;
            draw = function(){
                draw2();
            };
        }
    };
    if(scaledMouseX < 0){
        draw = function() {
            draw2();
        };
    }
};

var draw2 = function() {*/
var draw = function() {
    /*
    if (!storage) {
        storage = (function() {return this;})().localStorage;
        unloadGame();
    }
    */
    
    if(currentScene === "title"){
        previousScenes = ["title"];
    }
    
    if(!level){
        resetLevel();
    }
    
    textFont(loadFont(game.font, 0), 0);
    
    angleMode = "degrees";
    
    if((currentScene === "title" || currentScene === "levelSelect" || currentScene === "settings" || currentScene === "announcements" || currentScene === "LINKS") && previousScene() === "title" || currentScene === "FAQs" || currentScene === "LINKS"){
        titleBackground();
    }else{
        myBackground();
    }
    
    clearButtonsAndTextBoxes();
    
    switch(currentScene){
        case "title": title(); break;
        case "level": playLevel(); break;
        case "paused": playLevel(); pauseMenu(); break;
        case "win": playLevel(); winLevel(); break;
        case "levelSelect": levelSelect(); break;
        case "createLevel": createLevel(); break;
        case "createLevelMenu": createLevel(); createLevelMenu(); break;
        case "settings": settingsPage(); break;
        case "announcements": announcements(); break;
        case "FAQs": FAQs(); break;
        case "LINKS": links(); break;
        default:
            fill(255);
            textAlign(CENTER, CENTER);
            textSize(100);
            text("404", 200, 150);
            textSize(15);
            text("If you happen to know what button led you here,\nplease let DY know. Thanks for your cooperation.", 200, 240);
            
            btn(170, 285, 60, 25,
                "BACK", 14);
            btn(157.5, 320, 85, 25,
                "Main Menu", 14);
    }
    
    if(frameCount < splashTime){
        splash();
    }else if(frameCount === splashTime){
        beginningMessage();
    }
    
    //Advance scene change animations if necessary
    if(switchingScene){
        //No other events can be triggered during animation
        clearButtonsAndTextBoxes();
        switchScene(0, true);
    }
    
    //Display messages
    if(message.enabled){
        displayMessage();
    }

    mobileEdition();
    
    checkIfMouseOverButton();
};

//Transcolors Copyright © 2013-2015 DY. All rights reserved.
